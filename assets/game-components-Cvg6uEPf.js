import{r as Rt,g as Ie}from"./react-vendor-gH-7aFTg.js";function Pt(s,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const n in r)if(n!=="default"&&!(n in s)){const i=Object.getOwnPropertyDescriptor(r,n);i&&Object.defineProperty(s,n,i.get?i:{enumerable:!0,get:()=>r[n]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}var Z={exports:{}},G={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ye;function jt(){if(ye)return G;ye=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,n,i){var o=null;if(i!==void 0&&(o=""+i),n.key!==void 0&&(o=""+n.key),"key"in n){i={};for(var c in n)c!=="key"&&(i[c]=n[c])}else i=n;return n=i.ref,{$$typeof:s,type:r,key:o,ref:n!==void 0?n:null,props:i}}return G.Fragment=e,G.jsx=t,G.jsxs=t,G}var Ce;function Nt(){return Ce||(Ce=1,Z.exports=jt()),Z.exports}var a=Nt(),S=Rt();const ve=Ie(S),At=["Meus pais se juntaram e fizeram uma saita nova que agora ______.","É nessa loucura de dizer que não te quero, vou negando as aparências, disfarcando ______.","_______ colocou o Brasil no mapa.","Viver cercado de ______.","O fio que faz a piada do pavê é ______.","O editor das manchetes do Meia-Hora é ______.","Um cara chamado Jacinto Pinto é ______.","Mijar pela bunda é ______.","Ser calvo aos 20 anos é ______.","Acordar com fortes dores no cu é ______.","A melhor coisa sobre ter 18 anos é ______.","Minha avó sempre dizia: '______'.","O que mais me irrita no trabalho é ______.","Se eu fosse presidente por um dia, eu ______.","A pior desculpa para chegar atrasado é ______.","O que eu mais escondo dos meus pais é ______.","A receita secreta da Coca-Cola na verdade é ______.","O verdadeiro motivo da extinção dos dinossauros foi ______.","Se aliens visitassem a Terra, eles ficariam chocados com ______.","A única coisa pior que acordar cedo é ______.","Meu maior medo é ______.","Se eu pudesse voltar no tempo, eu ______.","O que realmente acontece quando você morre é ______.","A coisa mais embaraçosa que já fiz foi ______.","Se eu fosse invisível por um dia, eu ______.","O que eu faria com um milhão de reais seria ______.","A verdadeira razão pela qual o Brasil não vai pra frente é ______.","Se eu pudesse escolher minha morte, seria ______.","O que eu mais gostaria de falar para meu chefe é ______.","A coisa mais nojenta que já comi foi ______.","Se eu pudesse ler mentes, descobriria que ______.","O que realmente acontece no banheiro feminino é ______.","A profissão mais inútil do mundo é ______.","Se eu pudesse ter um superpoder, seria ______.","A coisa mais ridícula que já comprei foi ______.","O que eu faria se soubesse que o mundo ia acabar amanhã seria ______.","A verdadeira razão pela qual homens não pedem informação é ______.","Se eu pudesse conversar com animais, perguntaria ______.","A coisa mais constrangedora que aconteceu comigo no médico foi ______.","Se eu pudesse mudar uma coisa no meu corpo seria ______.","O que eu mais gostaria de esquecer é ______.","A pior coisa sobre ser adulto é ______.","Se eu pudesse viver para sempre, eu ______.","O que realmente acontece quando ninguém está olhando é ______.","A coisa mais estranha que já sonhei foi ______.","Se eu pudesse trocar de vida com alguém por um dia, seria ______.","O que eu mais gostaria de dizer para meu ex é ______.","A verdadeira razão pela qual sempre esqueço nomes é ______.","Se eu pudesse criar uma lei, seria ______.","A coisa mais idiota que já acreditei foi ______.","O que eu faria se ganhasse na loteria seria ______.","A verdadeira razão pela qual as pessoas fazem selfie é ______.","Se eu pudesse deletar algo da internet seria ______.","A coisa mais embaraçosa no meu histórico de navegação é ______.","Se eu pudesse falar com meu eu de 10 anos atrás, diria ______.","O que realmente pensam sobre mim quando não estou por perto é ______.","A pior tendência da moda foi ______.","Se eu pudesse banir uma coisa do mundo seria ______.","A coisa mais estranha que já encontrei no meu bolso foi ______.","Se eu pudesse hackear qualquer sistema, escolheria ______.","O que eu mais gostaria de automatizar na minha vida é ______.","A verdadeira razão pela qual procrastino é ______.","Se eu pudesse adicionar uma matéria na escola seria ______.","A coisa mais bizarra que já vi no transporte público foi ______.","Se eu pudesse ter acesso a qualquer informação secreta seria ______.","O que eu mais gostaria de perguntar para um político é ______.","A verdadeira razão pela qual o Wi-Fi sempre falha quando preciso é ______.","Se eu pudesse mudar o passado, mudaria ______.","A coisa mais ridícula que já fiz por amor foi ______.","Se eu pudesse controlar o clima por um dia, faria ______.","O que eu mais gostaria de confessar é ______.","A verdadeira utilidade do apêndice humano é ______.","Se eu pudesse dar um conselho para toda a humanidade seria ______.","A coisa mais inútil que aprendi na escola foi ______.","Se eu pudesse reviver um dia da minha vida seria ______.","O que eu mais gostaria de desdizer é ______.","A verdadeira razão pela qual gatos ronronam é ______.","Se eu pudesse mudar uma regra social seria ______.","A coisa mais estranha que já aconteceu comigo num elevador foi ______.","Se eu pudesse inventar um feriado seria ______.","O que eu mais gostaria de explicar para as gerações futuras é ______.","A verdadeira razão pela qual sempre perco meias na lavanderia é ______.","Se eu pudesse adicionar um novo sentido ao corpo humano seria ______.","A coisa mais absurda que já acreditei quando criança foi ______.","Se eu pudesse mudar o nome de alguma coisa seria ______.","O que eu mais gostaria de perguntar para Deus é ______.","A verdadeira razão pela qual sempre esqueço onde coloquei as coisas é ______.","Se eu pudesse criar um aplicativo seria para ______.","A coisa mais constrangedora que já aconteceu numa reunião de família foi ______.","Se eu pudesse ter um animal de estimação exótico seria ______.","O que eu mais gostaria de dizer para meu eu do futuro é ______.","A verdadeira razão pela qual sempre fico preso no trânsito é ______.","Se eu pudesse mudar uma coisa na natureza humana seria ______.","A coisa mais ridícula que já fiz para impressionar alguém foi ______.","Se eu pudesse criar uma nova profissão seria ______.","O que eu mais gostaria de esquecer que existe é ______."],Dt=["Um pênis gigante","Fazer cocô de pé","Minha virgindade","Cheirar o próprio sovaco","Bebês","Um anal bem feito","Peidar em elevador lotado","Comer pizza fria","Transar com o ex","Fingir que está dormindo","Lamber o prato","Usar calcinha suja","Chorar vendo filme da Xuxa","Dar match no Tinder com a prima","Cagar no banho","Masturbar-se pensando na sogra","Enfiar o dedo no nariz","Soltar pum durante o sexo","Comer lasanha com as mãos","Fazer xixi no chuveiro","Cheirar a própria cueca","Dar uma mijada épica","Comer pelo nariz","Transar de meia","Lamber o próprio cotovelo","Fazer cocô líquido","Cheirar peido dos outros","Comer meleca","Dar aquela estalada no saco","Chorar no banheiro","Mijar na pia","Cheirar o dedo depois de coçar","Comer cabelo","Transar com a luz acesa","Fazer strip-tease para o espelho","Lamber o próprio pé","Cagar em shopping","Cheirar calcinha usada","Dar uma cusparada marota","Chorar vendo comercial de margarina","Mijar no mato","Cheirar a própria bunda","Comer inseto","Transar no primeiro encontro","Fazer sexo oral mal feito","Lamber colher de nutella","Cagar de porta aberta","Cheirar pé sujo","Dar uma babada","Chorar ouvindo Pablo Vittar","Três cromossomos","Uma lobotomia","Pelos púbicos","Diarréia explosiva","Um orgasmo múltiplo","Sexo anal","Fazer xixi na cama","Chupar dedo do pé","Um feto morto","Pornografia de anões","Fazer cocô na rua","Cheirar cueca alheia","Dar o cu","Comer terra","Enfiar o dedo na bunda","Soltar gases tóxicos","Chupar chupeta de criança","Um aborto espontâneo","Pornografia incestuosa","Fazer xixi de pé sendo mulher","Cheirar tênis velho","Dar uma sentada","Comer cola","Enfiar cotonete na orelha","Soltar arroto alto","Chupar bico de mamadeira","Uma cirurgia plástica mal feita","Pornografia gospel","Fazer cocô verde","Cheirar papel higiênico usado","Dar uma mamada","Comer grama","Enfiar palito no dente","Soltar peido silencioso mas mortal","Chupar chuchu","Um parto prematuro","Pornografia com idosos","Fazer xixi amarelo neon","Cheirar desodorante vencido","Dar uma dedada","Comer papel","Enfiar cotonete no nariz","Soltar gases metanos","Chupar manga com sal","Uma ejaculação precoce","Pornografia com animais","Fazer cocô pastoso","Cheirar meia suja","Dar uma chupada","Comer sabonete","Enfiar palito na unha","Soltar pum com cheiro de ovo podre","Chupar pirulito do chão","Uma ereção na hora errada","Pornografia bizarra","A menstruação","Pelos no cu","Corrimento vaginal","Esperma de baleia","Uma fimose","Hemorróidas","Fazer xixi em público","Cheirar perfume barato","Dar uma roçada","Comer unha","Enfiar canudo no nariz","Soltar peido em igreja","Chupar limão sem açúcar","Uma vasectomia","Pornografia amadora","Fazer cocô duro","Cheirar sabonete usado","Dar uma apertada","Comer isopor","Enfiar grampo no ouvido","Soltar gases em reunião","Chupar osso de galinha","Uma laqueadura","Pornografia profissional","Fazer xixi espumoso","Cheirar pasta de dente vencida","Dar uma beliscada","Comer algodão","Enfiar clipe na pele","Soltar arroto em missa","Chupar caroço de manga","Uma circuncisão","Pornografia romântica","Fazer cocô com sangue","Cheirar shampoo estragado","Dar uma mordida","Comer borracha","Enfiar linha na gengiva","Soltar peido no cinema","Chupar gelo sujo","Uma histerectomia","Pornografia educativa","Fazer xixi com espuma","Cheirar condicionador azedo","Dar uma lambida","Comer madeira","Enfiar fio dental na orelha","Soltar gases no trabalho","Chupar bala velha","Uma mudança de sexo","Pornografia científica","Fazer cocô líquido amarelo","Cheirar creme rinse estragado","Dar uma sugada","Comer cimento","Enfiar palito de fósforo no dente","Soltar arroto na escola","Chupar doce do chão","Uma operação no saco","Pornografia filosófica","Fazer xixi roxo","Cheirar gel vencido","Dar uma esfregada","Comer tijolo","Enfiar agulha na unha","Soltar peido na academia","Chupar chiclete usado","Uma cirurgia íntima","Pornografia metafísica","Fazer cocô verde limão","Cheirar mousse estragado","Dar uma raspada","Comer ferro","Enfiar espinho no pé","Soltar gases no elevador","Chupar sorvete derretido","Uma plástica nos genitais","Pornografia existencial","Fazer xixi verde","Cheirar cera vencida","Dar uma cutucada","Comer vidro","Enfiar farpa na mão","Soltar arroto no hospital","Chupar bala azeda","Uma reversão de vasectomia","Pornografia minimalista","Fazer cocô marrom escuro","Cheirar pomada estragada","Dar uma agarrada","Comer concreto","Enfiar cisco no olho","Soltar peido na farmácia","Chupar pirulito velho","Uma reconstrução vaginal","Pornografia maximalista","Fazer xixi laranja","Cheirar loção azeda","Dar uma espremida","Comer cal","Enfiar fiapo no nariz","Soltar gases no supermercado","Chupar doce pegajoso","Uma cirurgia estética íntima","Pornografia impressionista","Fazer cocô preto","Cheirar óleo vencido","Dar uma espreitada","Comer argila","Enfiar sujeira na orelha","Soltar arroto no restaurante","Chupar caramelo grudento","Uma mudança hormonal","Pornografia cubista","Fazer xixi azul","Cheirar sabão estragado","Dar uma beliscadinha","Comer gesso","Enfiar pó no nariz","Soltar peido no ônibus","Chupar bala derretida","Uma terapia hormonal","Pornografia surrealista","Fazer cocô amarelo","Cheirar detergente vencido","Dar uma coceguinha","Comer massa corrida","Enfiar poeira na boca","Soltar gases no metrô","Chupar drops grudento","Uma reversão de laqueadura","Pornografia realista","Fazer xixi rosa","Cheirar amaciante azedo","Dar uma piscadinha","Comer tinta","Enfiar felpudo no dente","Soltar arroto no táxi","Chupar jujuba velha","Uma cirurgia reconstrutiva","Pornografia abstrata","Fazer cocô cinza","Cheirar álcool vencido","Dar uma puxadinha","Comer verniz","Enfiar pelos no nariz","Soltar peido no avião","Chupar gelatina mole","Uma mudança corporal radical","Pornografia conceitual","Fazer xixi transparente","Cheirar acetona estragada","Dar uma apertadinha","Comer massa de vidraceiro","Enfiar cabelo na garganta","Soltar gases no navio","Chupar pudim mole","Uma transformação genética","Pornografia dadaísta","Fazer cocô branco","Cheirar removedor vencido","Dar uma mordidinha","Comer cola de sapateiro","Enfiar linha na narina","Soltar arroto no trem","Chupar mousse derretido","Uma modificação corporal","Pornografia pop art","Fazer xixi prateado","Cheirar thinner estragado","Dar uma lambidinha","Comer massa de calafetar","Enfiar fio na orelha","Soltar peido no barco","Chupar creme bavette","Uma alteração física permanente","Pornografia neo-clássica","Fazer cocô dourado","Cheirar gasolina velha","Dar uma sugadinha","Comer betume","Enfiar barbante no nariz","Soltar gases na balsa","Chupar leite condensado azedo","Uma mutação genética","Pornografia barroca","Fazer xixi dourado","Cheirar querosene vencido","Dar uma chupetinha","Comer piche","Enfiar cordão na boca","Soltar arroto na lancha","Chupar mel cristalizado","Uma evolução corporal","Pornografia gótica","Seus pais fazendo sexo","Crianças em uma mina de carvão","Uma saia justa constrangedora","Dançar até o chão","Fazer um stripper privado","Lamber bolas de golfe","Chupar uma banana seductivamente","Abraçar muito forte","Fingir um orgasmo","Gritar como Tarzan","Imitar um porno","Dançar funk","Fazer cara de ahegao","Gemer alto","Rebolar gostoso","Dar uma sentada épica","Fazer biquinho","Piscar seductivamente","Rebolado da Anitta","Gemidão do WhatsApp"],Oe=s=>{const e=[...s];for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e},kt=(s,e=10)=>{const t=Oe(Dt),r={};return s.forEach((n,i)=>{const o=i*e,c=o+e;r[n.id]=t.slice(o,c)}),{playerHands:r,remainingCards:t.slice(s.length*e)}},It=(s=[])=>{const e=At.filter(r=>!s.includes(r));if(e.length===0)return null;const t=Math.floor(Math.random()*e.length);return e[t]};class Ot{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(e){this.flush(),this._parts.push(e)}append(e){this._pieces.push(e)}flush(){if(this._pieces.length>0){const e=new Uint8Array(this._pieces);this._parts.push(e),this._pieces=[]}}toArrayBuffer(){const e=[];for(const t of this._parts)e.push(t);return Mt(e).buffer}}function Mt(s){let e=0;for(const n of s)e+=n.byteLength;const t=new Uint8Array(e);let r=0;for(const n of s){const i=new Uint8Array(n.buffer,n.byteOffset,n.byteLength);t.set(i,r),r+=n.byteLength}return t}function Me(s){return new Lt(s).unpack()}function Le(s){const e=new $t,t=e.pack(s);return t instanceof Promise?t.then(()=>e.getBuffer()):e.getBuffer()}class Lt{constructor(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const e=this.unpack_uint8();if(e<128)return e;if((e^224)<32)return(e^224)-32;let t;if((t=e^160)<=15)return this.unpack_raw(t);if((t=e^176)<=15)return this.unpack_string(t);if((t=e^144)<=15)return this.unpack_array(t);if((t=e^128)<=15)return this.unpack_map(t);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return t=this.unpack_uint16(),this.unpack_string(t);case 217:return t=this.unpack_uint32(),this.unpack_string(t);case 218:return t=this.unpack_uint16(),this.unpack_raw(t);case 219:return t=this.unpack_uint32(),this.unpack_raw(t);case 220:return t=this.unpack_uint16(),this.unpack_array(t);case 221:return t=this.unpack_uint32(),this.unpack_array(t);case 222:return t=this.unpack_uint16(),this.unpack_map(t);case 223:return t=this.unpack_uint32(),this.unpack_map(t)}}unpack_uint8(){const e=this.dataView[this.index]&255;return this.index++,e}unpack_uint16(){const e=this.read(2),t=(e[0]&255)*256+(e[1]&255);return this.index+=2,t}unpack_uint32(){const e=this.read(4),t=((e[0]*256+e[1])*256+e[2])*256+e[3];return this.index+=4,t}unpack_uint64(){const e=this.read(8),t=((((((e[0]*256+e[1])*256+e[2])*256+e[3])*256+e[4])*256+e[5])*256+e[6])*256+e[7];return this.index+=8,t}unpack_int8(){const e=this.unpack_uint8();return e<128?e:e-256}unpack_int16(){const e=this.unpack_uint16();return e<32768?e:e-65536}unpack_int32(){const e=this.unpack_uint32();return e<2**31?e:e-2**32}unpack_int64(){const e=this.unpack_uint64();return e<2**63?e:e-2**64}unpack_raw(e){if(this.length<this.index+e)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${e} ${this.length}`);const t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t}unpack_string(e){const t=this.read(e);let r=0,n="",i,o;for(;r<e;)i=t[r],i<160?(o=i,r++):(i^192)<32?(o=(i&31)<<6|t[r+1]&63,r+=2):(i^224)<16?(o=(i&15)<<12|(t[r+1]&63)<<6|t[r+2]&63,r+=3):(o=(i&7)<<18|(t[r+1]&63)<<12|(t[r+2]&63)<<6|t[r+3]&63,r+=4),n+=String.fromCodePoint(o);return this.index+=e,n}unpack_array(e){const t=new Array(e);for(let r=0;r<e;r++)t[r]=this.unpack();return t}unpack_map(e){const t={};for(let r=0;r<e;r++){const n=this.unpack();t[n]=this.unpack()}return t}unpack_float(){const e=this.unpack_uint32(),t=e>>31,r=(e>>23&255)-127,n=e&8388607|8388608;return(t===0?1:-1)*n*2**(r-23)}unpack_double(){const e=this.unpack_uint32(),t=this.unpack_uint32(),r=e>>31,n=(e>>20&2047)-1023,o=(e&1048575|1048576)*2**(n-20)+t*2**(n-52);return(r===0?1:-1)*o}read(e){const t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")}}class $t{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(e){if(typeof e=="string")this.pack_string(e);else if(typeof e=="number")Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if(typeof e=="boolean")e===!0?this._bufferBuilder.append(195):e===!1&&this._bufferBuilder.append(194);else if(e===void 0)this._bufferBuilder.append(192);else if(typeof e=="object")if(e===null)this._bufferBuilder.append(192);else{const t=e.constructor;if(e instanceof Array){const r=this.pack_array(e);if(r instanceof Promise)return r.then(()=>this._bufferBuilder.flush())}else if(e instanceof ArrayBuffer)this.pack_bin(new Uint8Array(e));else if("BYTES_PER_ELEMENT"in e){const r=e;this.pack_bin(new Uint8Array(r.buffer,r.byteOffset,r.byteLength))}else if(e instanceof Date)this.pack_string(e.toString());else{if(e instanceof Blob)return e.arrayBuffer().then(r=>{this.pack_bin(new Uint8Array(r)),this._bufferBuilder.flush()});if(t==Object||t.toString().startsWith("class")){const r=this.pack_object(e);if(r instanceof Promise)return r.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${t.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof e}" not yet supported`);this._bufferBuilder.flush()}pack_bin(e){const t=e.length;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this._bufferBuilder.append(218),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(t);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(e)}pack_string(e){const t=this._textEncoder.encode(e),r=t.length;if(r<=15)this.pack_uint8(176+r);else if(r<=65535)this._bufferBuilder.append(216),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(r);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(t)}pack_array(e){const t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this._bufferBuilder.append(220),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(t);else throw new Error("Invalid length");const r=n=>{if(n<t){const i=this.pack(e[n]);return i instanceof Promise?i.then(()=>r(n+1)):r(n+1)}};return r(0)}pack_integer(e){if(e>=-32&&e<=127)this._bufferBuilder.append(e&255);else if(e>=0&&e<=255)this._bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this._bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this._bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this._bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this._bufferBuilder.append(210),this.pack_int32(e);else if(e>=-9223372036854776e3&&e<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(e);else if(e>=0&&e<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(e);else throw new Error("Invalid integer")}pack_double(e){let t=0;e<0&&(t=1,e=-e);const r=Math.floor(Math.log(e)/Math.LN2),n=e/2**r-1,i=Math.floor(n*2**52),o=2**32,c=t<<31|r+1023<<20|i/o&1048575,d=i%o;this._bufferBuilder.append(203),this.pack_int32(c),this.pack_int32(d)}pack_object(e){const t=Object.keys(e),r=t.length;if(r<=15)this.pack_uint8(128+r);else if(r<=65535)this._bufferBuilder.append(222),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(r);else throw new Error("Invalid length");const n=i=>{if(i<t.length){const o=t[i];if(e.hasOwnProperty(o)){this.pack(o);const c=this.pack(e[o]);if(c instanceof Promise)return c.then(()=>n(i+1))}return n(i+1)}};return n(0)}pack_uint8(e){this._bufferBuilder.append(e)}pack_uint16(e){this._bufferBuilder.append(e>>8),this._bufferBuilder.append(e&255)}pack_uint32(e){const t=e&4294967295;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255)}pack_uint64(e){const t=e/4294967296,r=e%2**32;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255),this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}pack_int8(e){this._bufferBuilder.append(e&255)}pack_int16(e){this._bufferBuilder.append((e&65280)>>8),this._bufferBuilder.append(e&255)}pack_int32(e){this._bufferBuilder.append(e>>>24&255),this._bufferBuilder.append((e&16711680)>>>16),this._bufferBuilder.append((e&65280)>>>8),this._bufferBuilder.append(e&255)}pack_int64(e){const t=Math.floor(e/4294967296),r=e%2**32;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255),this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}constructor(){this._bufferBuilder=new Ot,this._textEncoder=new TextEncoder}}let $e=!0,Fe=!0;function B(s,e,t){const r=s.match(e);return r&&r.length>=t&&parseFloat(r[t],10)}function O(s,e,t){if(!s.RTCPeerConnection)return;const r=s.RTCPeerConnection.prototype,n=r.addEventListener;r.addEventListener=function(o,c){if(o!==e)return n.apply(this,arguments);const d=u=>{const p=t(u);p&&(c.handleEvent?c.handleEvent(p):c(p))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(c,d),n.apply(this,[o,d])};const i=r.removeEventListener;r.removeEventListener=function(o,c){if(o!==e||!this._eventMap||!this._eventMap[e])return i.apply(this,arguments);if(!this._eventMap[e].has(c))return i.apply(this,arguments);const d=this._eventMap[e].get(c);return this._eventMap[e].delete(c),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,i.apply(this,[o,d])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(o){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),o&&this.addEventListener(e,this["_on"+e]=o)},enumerable:!0,configurable:!0})}function Ft(s){return typeof s!="boolean"?new Error("Argument type: "+typeof s+". Please use a boolean."):($e=s,s?"adapter.js logging disabled":"adapter.js logging enabled")}function Ut(s){return typeof s!="boolean"?new Error("Argument type: "+typeof s+". Please use a boolean."):(Fe=!s,"adapter.js deprecation warnings "+(s?"disabled":"enabled"))}function Ue(){if(typeof window=="object"){if($e)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function ue(s,e){Fe&&console.warn(s+" is deprecated, please use "+e+" instead.")}function Gt(s){const e={browser:null,version:null};if(typeof s>"u"||!s.navigator||!s.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:t}=s;if(t.userAgentData&&t.userAgentData.brands){const r=t.userAgentData.brands.find(n=>n.brand==="Chromium");if(r)return{browser:"chrome",version:parseInt(r.version,10)}}if(t.mozGetUserMedia)e.browser="firefox",e.version=parseInt(B(t.userAgent,/Firefox\/(\d+)\./,1));else if(t.webkitGetUserMedia||s.isSecureContext===!1&&s.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(B(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(s.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(B(t.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=s.RTCRtpTransceiver&&"currentDirection"in s.RTCRtpTransceiver.prototype,e._safariVersion=B(t.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function Se(s){return Object.prototype.toString.call(s)==="[object Object]"}function Ge(s){return Se(s)?Object.keys(s).reduce(function(e,t){const r=Se(s[t]),n=r?Ge(s[t]):s[t],i=r&&!Object.keys(n).length;return n===void 0||i?e:Object.assign(e,{[t]:n})},{}):s}function ne(s,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?ne(s,s.get(e[r]),t):r.endsWith("Ids")&&e[r].forEach(n=>{ne(s,s.get(n),t)})}))}function xe(s,e,t){const r=t?"outbound-rtp":"inbound-rtp",n=new Map;if(e===null)return n;const i=[];return s.forEach(o=>{o.type==="track"&&o.trackIdentifier===e.id&&i.push(o)}),i.forEach(o=>{s.forEach(c=>{c.type===r&&c.trackId===o.id&&ne(s,c,n)})}),n}const be=Ue;function ze(s,e){const t=s&&s.navigator;if(!t.mediaDevices)return;const r=function(c){if(typeof c!="object"||c.mandatory||c.optional)return c;const d={};return Object.keys(c).forEach(u=>{if(u==="require"||u==="advanced"||u==="mediaSource")return;const p=typeof c[u]=="object"?c[u]:{ideal:c[u]};p.exact!==void 0&&typeof p.exact=="number"&&(p.min=p.max=p.exact);const l=function(h,_){return h?h+_.charAt(0).toUpperCase()+_.slice(1):_==="deviceId"?"sourceId":_};if(p.ideal!==void 0){d.optional=d.optional||[];let h={};typeof p.ideal=="number"?(h[l("min",u)]=p.ideal,d.optional.push(h),h={},h[l("max",u)]=p.ideal,d.optional.push(h)):(h[l("",u)]=p.ideal,d.optional.push(h))}p.exact!==void 0&&typeof p.exact!="number"?(d.mandatory=d.mandatory||{},d.mandatory[l("",u)]=p.exact):["min","max"].forEach(h=>{p[h]!==void 0&&(d.mandatory=d.mandatory||{},d.mandatory[l(h,u)]=p[h])})}),c.advanced&&(d.optional=(d.optional||[]).concat(c.advanced)),d},n=function(c,d){if(e.version>=61)return d(c);if(c=JSON.parse(JSON.stringify(c)),c&&typeof c.audio=="object"){const u=function(p,l,h){l in p&&!(h in p)&&(p[h]=p[l],delete p[l])};c=JSON.parse(JSON.stringify(c)),u(c.audio,"autoGainControl","googAutoGainControl"),u(c.audio,"noiseSuppression","googNoiseSuppression"),c.audio=r(c.audio)}if(c&&typeof c.video=="object"){let u=c.video.facingMode;u=u&&(typeof u=="object"?u:{ideal:u});const p=e.version<66;if(u&&(u.exact==="user"||u.exact==="environment"||u.ideal==="user"||u.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!p)){delete c.video.facingMode;let l;if(u.exact==="environment"||u.ideal==="environment"?l=["back","rear"]:(u.exact==="user"||u.ideal==="user")&&(l=["front"]),l)return t.mediaDevices.enumerateDevices().then(h=>{h=h.filter(m=>m.kind==="videoinput");let _=h.find(m=>l.some(v=>m.label.toLowerCase().includes(v)));return!_&&h.length&&l.includes("back")&&(_=h[h.length-1]),_&&(c.video.deviceId=u.exact?{exact:_.deviceId}:{ideal:_.deviceId}),c.video=r(c.video),be("chrome: "+JSON.stringify(c)),d(c)})}c.video=r(c.video)}return be("chrome: "+JSON.stringify(c)),d(c)},i=function(c){return e.version>=64?c:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[c.name]||c.name,message:c.message,constraint:c.constraint||c.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},o=function(c,d,u){n(c,p=>{t.webkitGetUserMedia(p,d,l=>{u&&u(i(l))})})};if(t.getUserMedia=o.bind(t),t.mediaDevices.getUserMedia){const c=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(d){return n(d,u=>c(u).then(p=>{if(u.audio&&!p.getAudioTracks().length||u.video&&!p.getVideoTracks().length)throw p.getTracks().forEach(l=>{l.stop()}),new DOMException("","NotFoundError");return p},p=>Promise.reject(i(p))))}}}function Be(s){s.MediaStream=s.MediaStream||s.webkitMediaStream}function He(s){if(typeof s=="object"&&s.RTCPeerConnection&&!("ontrack"in s.RTCPeerConnection.prototype)){Object.defineProperty(s.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const e=s.RTCPeerConnection.prototype.setRemoteDescription;s.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",n=>{let i;s.RTCPeerConnection.prototype.getReceivers?i=this.getReceivers().find(c=>c.track&&c.track.id===n.track.id):i={track:n.track};const o=new Event("track");o.track=n.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[r.stream],this.dispatchEvent(o)}),r.stream.getTracks().forEach(n=>{let i;s.RTCPeerConnection.prototype.getReceivers?i=this.getReceivers().find(c=>c.track&&c.track.id===n.id):i={track:n};const o=new Event("track");o.track=n,o.receiver=i,o.transceiver={receiver:i},o.streams=[r.stream],this.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else O(s,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function qe(s){if(typeof s=="object"&&s.RTCPeerConnection&&!("getSenders"in s.RTCPeerConnection.prototype)&&"createDTMFSender"in s.RTCPeerConnection.prototype){const e=function(n,i){return{track:i,get dtmf(){return this._dtmf===void 0&&(i.kind==="audio"?this._dtmf=n.createDTMFSender(i):this._dtmf=null),this._dtmf},_pc:n}};if(!s.RTCPeerConnection.prototype.getSenders){s.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=s.RTCPeerConnection.prototype.addTrack;s.RTCPeerConnection.prototype.addTrack=function(c,d){let u=n.apply(this,arguments);return u||(u=e(this,c),this._senders.push(u)),u};const i=s.RTCPeerConnection.prototype.removeTrack;s.RTCPeerConnection.prototype.removeTrack=function(c){i.apply(this,arguments);const d=this._senders.indexOf(c);d!==-1&&this._senders.splice(d,1)}}const t=s.RTCPeerConnection.prototype.addStream;s.RTCPeerConnection.prototype.addStream=function(i){this._senders=this._senders||[],t.apply(this,[i]),i.getTracks().forEach(o=>{this._senders.push(e(this,o))})};const r=s.RTCPeerConnection.prototype.removeStream;s.RTCPeerConnection.prototype.removeStream=function(i){this._senders=this._senders||[],r.apply(this,[i]),i.getTracks().forEach(o=>{const c=this._senders.find(d=>d.track===o);c&&this._senders.splice(this._senders.indexOf(c),1)})}}else if(typeof s=="object"&&s.RTCPeerConnection&&"getSenders"in s.RTCPeerConnection.prototype&&"createDTMFSender"in s.RTCPeerConnection.prototype&&s.RTCRtpSender&&!("dtmf"in s.RTCRtpSender.prototype)){const e=s.RTCPeerConnection.prototype.getSenders;s.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(n=>n._pc=this),r},Object.defineProperty(s.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Ye(s){if(!(typeof s=="object"&&s.RTCPeerConnection&&s.RTCRtpSender&&s.RTCRtpReceiver))return;if(!("getStats"in s.RTCRtpSender.prototype)){const t=s.RTCPeerConnection.prototype.getSenders;t&&(s.RTCPeerConnection.prototype.getSenders=function(){const i=t.apply(this,[]);return i.forEach(o=>o._pc=this),i});const r=s.RTCPeerConnection.prototype.addTrack;r&&(s.RTCPeerConnection.prototype.addTrack=function(){const i=r.apply(this,arguments);return i._pc=this,i}),s.RTCRtpSender.prototype.getStats=function(){const i=this;return this._pc.getStats().then(o=>xe(o,i.track,!0))}}if(!("getStats"in s.RTCRtpReceiver.prototype)){const t=s.RTCPeerConnection.prototype.getReceivers;t&&(s.RTCPeerConnection.prototype.getReceivers=function(){const n=t.apply(this,[]);return n.forEach(i=>i._pc=this),n}),O(s,"track",r=>(r.receiver._pc=r.srcElement,r)),s.RTCRtpReceiver.prototype.getStats=function(){const n=this;return this._pc.getStats().then(i=>xe(i,n.track,!1))}}if(!("getStats"in s.RTCRtpSender.prototype&&"getStats"in s.RTCRtpReceiver.prototype))return;const e=s.RTCPeerConnection.prototype.getStats;s.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof s.MediaStreamTrack){const r=arguments[0];let n,i,o;return this.getSenders().forEach(c=>{c.track===r&&(n?o=!0:n=c)}),this.getReceivers().forEach(c=>(c.track===r&&(i?o=!0:i=c),c.track===r)),o||n&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function we(s){s.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(o=>this._shimmedLocalStreams[o][0])};const e=s.RTCPeerConnection.prototype.addTrack;s.RTCPeerConnection.prototype.addTrack=function(o,c){if(!c)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const d=e.apply(this,arguments);return this._shimmedLocalStreams[c.id]?this._shimmedLocalStreams[c.id].indexOf(d)===-1&&this._shimmedLocalStreams[c.id].push(d):this._shimmedLocalStreams[c.id]=[c,d],d};const t=s.RTCPeerConnection.prototype.addStream;s.RTCPeerConnection.prototype.addStream=function(o){this._shimmedLocalStreams=this._shimmedLocalStreams||{},o.getTracks().forEach(u=>{if(this.getSenders().find(l=>l.track===u))throw new DOMException("Track already exists.","InvalidAccessError")});const c=this.getSenders();t.apply(this,arguments);const d=this.getSenders().filter(u=>c.indexOf(u)===-1);this._shimmedLocalStreams[o.id]=[o].concat(d)};const r=s.RTCPeerConnection.prototype.removeStream;s.RTCPeerConnection.prototype.removeStream=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[o.id],r.apply(this,arguments)};const n=s.RTCPeerConnection.prototype.removeTrack;s.RTCPeerConnection.prototype.removeTrack=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},o&&Object.keys(this._shimmedLocalStreams).forEach(c=>{const d=this._shimmedLocalStreams[c].indexOf(o);d!==-1&&this._shimmedLocalStreams[c].splice(d,1),this._shimmedLocalStreams[c].length===1&&delete this._shimmedLocalStreams[c]}),n.apply(this,arguments)}}function We(s,e){if(!s.RTCPeerConnection)return;if(s.RTCPeerConnection.prototype.addTrack&&e.version>=65)return we(s);const t=s.RTCPeerConnection.prototype.getLocalStreams;s.RTCPeerConnection.prototype.getLocalStreams=function(){const p=t.apply(this);return this._reverseStreams=this._reverseStreams||{},p.map(l=>this._reverseStreams[l.id])};const r=s.RTCPeerConnection.prototype.addStream;s.RTCPeerConnection.prototype.addStream=function(p){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},p.getTracks().forEach(l=>{if(this.getSenders().find(_=>_.track===l))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[p.id]){const l=new s.MediaStream(p.getTracks());this._streams[p.id]=l,this._reverseStreams[l.id]=p,p=l}r.apply(this,[p])};const n=s.RTCPeerConnection.prototype.removeStream;s.RTCPeerConnection.prototype.removeStream=function(p){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},n.apply(this,[this._streams[p.id]||p]),delete this._reverseStreams[this._streams[p.id]?this._streams[p.id].id:p.id],delete this._streams[p.id]},s.RTCPeerConnection.prototype.addTrack=function(p,l){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const h=[].slice.call(arguments,1);if(h.length!==1||!h[0].getTracks().find(v=>v===p))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(v=>v.track===p))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const m=this._streams[l.id];if(m)m.addTrack(p),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const v=new s.MediaStream([p]);this._streams[l.id]=v,this._reverseStreams[v.id]=l,this.addStream(v)}return this.getSenders().find(v=>v.track===p)};function i(u,p){let l=p.sdp;return Object.keys(u._reverseStreams||[]).forEach(h=>{const _=u._reverseStreams[h],m=u._streams[_.id];l=l.replace(new RegExp(m.id,"g"),_.id)}),new RTCSessionDescription({type:p.type,sdp:l})}function o(u,p){let l=p.sdp;return Object.keys(u._reverseStreams||[]).forEach(h=>{const _=u._reverseStreams[h],m=u._streams[_.id];l=l.replace(new RegExp(_.id,"g"),m.id)}),new RTCSessionDescription({type:p.type,sdp:l})}["createOffer","createAnswer"].forEach(function(u){const p=s.RTCPeerConnection.prototype[u],l={[u](){const h=arguments;return arguments.length&&typeof arguments[0]=="function"?p.apply(this,[m=>{const v=i(this,m);h[0].apply(null,[v])},m=>{h[1]&&h[1].apply(null,m)},arguments[2]]):p.apply(this,arguments).then(m=>i(this,m))}};s.RTCPeerConnection.prototype[u]=l[u]});const c=s.RTCPeerConnection.prototype.setLocalDescription;s.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?c.apply(this,arguments):(arguments[0]=o(this,arguments[0]),c.apply(this,arguments))};const d=Object.getOwnPropertyDescriptor(s.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(s.RTCPeerConnection.prototype,"localDescription",{get(){const u=d.get.apply(this);return u.type===""?u:i(this,u)}}),s.RTCPeerConnection.prototype.removeTrack=function(p){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!p._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(p._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let h;Object.keys(this._streams).forEach(_=>{this._streams[_].getTracks().find(v=>p.track===v)&&(h=this._streams[_])}),h&&(h.getTracks().length===1?this.removeStream(this._reverseStreams[h.id]):h.removeTrack(p.track),this.dispatchEvent(new Event("negotiationneeded")))}}function ae(s,e){!s.RTCPeerConnection&&s.webkitRTCPeerConnection&&(s.RTCPeerConnection=s.webkitRTCPeerConnection),s.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const r=s.RTCPeerConnection.prototype[t],n={[t](){return arguments[0]=new(t==="addIceCandidate"?s.RTCIceCandidate:s.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};s.RTCPeerConnection.prototype[t]=n[t]})}function Ve(s,e){O(s,"negotiationneeded",t=>{const r=t.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return t})}const Ee=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:Ve,shimAddTrackRemoveTrack:We,shimAddTrackRemoveTrackWithNative:we,shimGetSendersWithDtmf:qe,shimGetUserMedia:ze,shimMediaStream:Be,shimOnTrack:He,shimPeerConnection:ae,shimSenderReceiverGetStats:Ye},Symbol.toStringTag,{value:"Module"}));function Je(s,e){const t=s&&s.navigator,r=s&&s.MediaStreamTrack;if(t.getUserMedia=function(n,i,o){ue("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(n).then(i,o)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const n=function(o,c,d){c in o&&!(d in o)&&(o[d]=o[c],delete o[c])},i=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(o){return typeof o=="object"&&typeof o.audio=="object"&&(o=JSON.parse(JSON.stringify(o)),n(o.audio,"autoGainControl","mozAutoGainControl"),n(o.audio,"noiseSuppression","mozNoiseSuppression")),i(o)},r&&r.prototype.getSettings){const o=r.prototype.getSettings;r.prototype.getSettings=function(){const c=o.apply(this,arguments);return n(c,"mozAutoGainControl","autoGainControl"),n(c,"mozNoiseSuppression","noiseSuppression"),c}}if(r&&r.prototype.applyConstraints){const o=r.prototype.applyConstraints;r.prototype.applyConstraints=function(c){return this.kind==="audio"&&typeof c=="object"&&(c=JSON.parse(JSON.stringify(c)),n(c,"autoGainControl","mozAutoGainControl"),n(c,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[c])}}}}function zt(s,e){s.navigator.mediaDevices&&"getDisplayMedia"in s.navigator.mediaDevices||s.navigator.mediaDevices&&(s.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,s.navigator.mediaDevices.getUserMedia(r)})}function Qe(s){typeof s=="object"&&s.RTCTrackEvent&&"receiver"in s.RTCTrackEvent.prototype&&!("transceiver"in s.RTCTrackEvent.prototype)&&Object.defineProperty(s.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ie(s,e){if(typeof s!="object"||!(s.RTCPeerConnection||s.mozRTCPeerConnection))return;!s.RTCPeerConnection&&s.mozRTCPeerConnection&&(s.RTCPeerConnection=s.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const i=s.RTCPeerConnection.prototype[n],o={[n](){return arguments[0]=new(n==="addIceCandidate"?s.RTCIceCandidate:s.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};s.RTCPeerConnection.prototype[n]=o[n]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=s.RTCPeerConnection.prototype.getStats;s.RTCPeerConnection.prototype.getStats=function(){const[i,o,c]=arguments;return r.apply(this,[i||null]).then(d=>{if(e.version<53&&!o)try{d.forEach(u=>{u.type=t[u.type]||u.type})}catch(u){if(u.name!=="TypeError")throw u;d.forEach((p,l)=>{d.set(l,Object.assign({},p,{type:t[p.type]||p.type}))})}return d}).then(o,c)}}function Ke(s){if(!(typeof s=="object"&&s.RTCPeerConnection&&s.RTCRtpSender)||s.RTCRtpSender&&"getStats"in s.RTCRtpSender.prototype)return;const e=s.RTCPeerConnection.prototype.getSenders;e&&(s.RTCPeerConnection.prototype.getSenders=function(){const n=e.apply(this,[]);return n.forEach(i=>i._pc=this),n});const t=s.RTCPeerConnection.prototype.addTrack;t&&(s.RTCPeerConnection.prototype.addTrack=function(){const n=t.apply(this,arguments);return n._pc=this,n}),s.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Xe(s){if(!(typeof s=="object"&&s.RTCPeerConnection&&s.RTCRtpSender)||s.RTCRtpSender&&"getStats"in s.RTCRtpReceiver.prototype)return;const e=s.RTCPeerConnection.prototype.getReceivers;e&&(s.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(n=>n._pc=this),r}),O(s,"track",t=>(t.receiver._pc=t.srcElement,t)),s.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Ze(s){!s.RTCPeerConnection||"removeStream"in s.RTCPeerConnection.prototype||(s.RTCPeerConnection.prototype.removeStream=function(t){ue("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&t.getTracks().includes(r.track)&&this.removeTrack(r)})})}function et(s){s.DataChannel&&!s.RTCDataChannel&&(s.RTCDataChannel=s.DataChannel)}function tt(s){if(!(typeof s=="object"&&s.RTCPeerConnection))return;const e=s.RTCPeerConnection.prototype.addTransceiver;e&&(s.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const n=r.length>0;n&&r.forEach(o=>{if("rid"in o&&!/^[a-z0-9]{0,16}$/i.test(o.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in o&&!(parseFloat(o.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in o&&!(parseFloat(o.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const i=e.apply(this,arguments);if(n){const{sender:o}=i,c=o.getParameters();(!("encodings"in c)||c.encodings.length===1&&Object.keys(c.encodings[0]).length===0)&&(c.encodings=r,o.sendEncodings=r,this.setParametersPromises.push(o.setParameters(c).then(()=>{delete o.sendEncodings}).catch(()=>{delete o.sendEncodings})))}return i})}function rt(s){if(!(typeof s=="object"&&s.RTCRtpSender))return;const e=s.RTCRtpSender.prototype.getParameters;e&&(s.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function st(s){if(!(typeof s=="object"&&s.RTCPeerConnection))return;const e=s.RTCPeerConnection.prototype.createOffer;s.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function nt(s){if(!(typeof s=="object"&&s.RTCPeerConnection))return;const e=s.RTCPeerConnection.prototype.createAnswer;s.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const Te=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:tt,shimCreateAnswer:nt,shimCreateOffer:st,shimGetDisplayMedia:zt,shimGetParameters:rt,shimGetUserMedia:Je,shimOnTrack:Qe,shimPeerConnection:ie,shimRTCDataChannel:et,shimReceiverGetStats:Xe,shimRemoveStream:Ze,shimSenderGetStats:Ke},Symbol.toStringTag,{value:"Module"}));function at(s){if(!(typeof s!="object"||!s.RTCPeerConnection)){if("getLocalStreams"in s.RTCPeerConnection.prototype||(s.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in s.RTCPeerConnection.prototype)){const e=s.RTCPeerConnection.prototype.addTrack;s.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(n=>e.call(this,n,r)),r.getVideoTracks().forEach(n=>e.call(this,n,r))},s.RTCPeerConnection.prototype.addTrack=function(r,...n){return n&&n.forEach(i=>{this._localStreams?this._localStreams.includes(i)||this._localStreams.push(i):this._localStreams=[i]}),e.apply(this,arguments)}}"removeStream"in s.RTCPeerConnection.prototype||(s.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(t);if(r===-1)return;this._localStreams.splice(r,1);const n=t.getTracks();this.getSenders().forEach(i=>{n.includes(i.track)&&this.removeTrack(i)})})}}function it(s){if(!(typeof s!="object"||!s.RTCPeerConnection)&&("getRemoteStreams"in s.RTCPeerConnection.prototype||(s.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in s.RTCPeerConnection.prototype))){Object.defineProperty(s.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(n=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(n))return;this._remoteStreams.push(n);const i=new Event("addstream");i.stream=n,this.dispatchEvent(i)})})}});const e=s.RTCPeerConnection.prototype.setRemoteDescription;s.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(n){n.streams.forEach(i=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(i)>=0)return;r._remoteStreams.push(i);const o=new Event("addstream");o.stream=i,r.dispatchEvent(o)})}),e.apply(r,arguments)}}}function ot(s){if(typeof s!="object"||!s.RTCPeerConnection)return;const e=s.RTCPeerConnection.prototype,t=e.createOffer,r=e.createAnswer,n=e.setLocalDescription,i=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(u,p){const l=arguments.length>=2?arguments[2]:arguments[0],h=t.apply(this,[l]);return p?(h.then(u,p),Promise.resolve()):h},e.createAnswer=function(u,p){const l=arguments.length>=2?arguments[2]:arguments[0],h=r.apply(this,[l]);return p?(h.then(u,p),Promise.resolve()):h};let c=function(d,u,p){const l=n.apply(this,[d]);return p?(l.then(u,p),Promise.resolve()):l};e.setLocalDescription=c,c=function(d,u,p){const l=i.apply(this,[d]);return p?(l.then(u,p),Promise.resolve()):l},e.setRemoteDescription=c,c=function(d,u,p){const l=o.apply(this,[d]);return p?(l.then(u,p),Promise.resolve()):l},e.addIceCandidate=c}function ct(s){const e=s&&s.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const t=e.mediaDevices,r=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=n=>r(dt(n))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,n,i){e.mediaDevices.getUserMedia(r).then(n,i)}).bind(e))}function dt(s){return s&&s.video!==void 0?Object.assign({},s,{video:Ge(s.video)}):s}function lt(s){if(!s.RTCPeerConnection)return;const e=s.RTCPeerConnection;s.RTCPeerConnection=function(r,n){if(r&&r.iceServers){const i=[];for(let o=0;o<r.iceServers.length;o++){let c=r.iceServers[o];c.urls===void 0&&c.url?(ue("RTCIceServer.url","RTCIceServer.urls"),c=JSON.parse(JSON.stringify(c)),c.urls=c.url,delete c.url,i.push(c)):i.push(r.iceServers[o])}r.iceServers=i}return new e(r,n)},s.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(s.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function ut(s){typeof s=="object"&&s.RTCTrackEvent&&"receiver"in s.RTCTrackEvent.prototype&&!("transceiver"in s.RTCTrackEvent.prototype)&&Object.defineProperty(s.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function pt(s){const e=s.RTCPeerConnection.prototype.createOffer;s.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const n=this.getTransceivers().find(o=>o.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&n?n.direction==="sendrecv"?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":n.direction==="recvonly"&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):r.offerToReceiveAudio===!0&&!n&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const i=this.getTransceivers().find(o=>o.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveVideo===!0&&!i&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function ht(s){typeof s!="object"||s.AudioContext||(s.AudioContext=s.webkitAudioContext)}const Re=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:ht,shimCallbacksAPI:ot,shimConstraints:dt,shimCreateOfferLegacy:pt,shimGetUserMedia:ct,shimLocalStreamsAPI:at,shimRTCIceServerUrls:lt,shimRemoteStreamsAPI:it,shimTrackEventTransceiver:ut},Symbol.toStringTag,{value:"Module"}));var ee={exports:{}},Pe;function Bt(){return Pe||(Pe=1,(function(s){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(t){return t.split(`
m=`).map((n,i)=>(i>0?"m="+n:n).trim()+`\r
`)},e.getDescription=function(t){const r=e.splitSections(t);return r&&r[0]},e.getMediaSections=function(t){const r=e.splitSections(t);return r.shift(),r},e.matchPrefix=function(t,r){return e.splitLines(t).filter(n=>n.indexOf(r)===0)},e.parseCandidate=function(t){let r;t.indexOf("a=candidate:")===0?r=t.substring(12).split(" "):r=t.substring(10).split(" ");const n={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let i=8;i<r.length;i+=2)switch(r[i]){case"raddr":n.relatedAddress=r[i+1];break;case"rport":n.relatedPort=parseInt(r[i+1],10);break;case"tcptype":n.tcpType=r[i+1];break;case"ufrag":n.ufrag=r[i+1],n.usernameFragment=r[i+1];break;default:n[r[i]]===void 0&&(n[r[i]]=r[i+1]);break}return n},e.writeCandidate=function(t){const r=[];r.push(t.foundation);const n=t.component;n==="rtp"?r.push(1):n==="rtcp"?r.push(2):r.push(n),r.push(t.protocol.toUpperCase()),r.push(t.priority),r.push(t.address||t.ip),r.push(t.port);const i=t.type;return r.push("typ"),r.push(i),i!=="host"&&t.relatedAddress&&t.relatedPort&&(r.push("raddr"),r.push(t.relatedAddress),r.push("rport"),r.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(r.push("ufrag"),r.push(t.usernameFragment||t.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(t){return t.substring(14).split(" ")},e.parseRtpMap=function(t){let r=t.substring(9).split(" ");const n={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),n.name=r[0],n.clockRate=parseInt(r[1],10),n.channels=r.length===3?parseInt(r[2],10):1,n.numChannels=n.channels,n},e.writeRtpMap=function(t){let r=t.payloadType;t.preferredPayloadType!==void 0&&(r=t.preferredPayloadType);const n=t.channels||t.numChannels||1;return"a=rtpmap:"+r+" "+t.name+"/"+t.clockRate+(n!==1?"/"+n:"")+`\r
`},e.parseExtmap=function(t){const r=t.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},e.parseFmtp=function(t){const r={};let n;const i=t.substring(t.indexOf(" ")+1).split(";");for(let o=0;o<i.length;o++)n=i[o].trim().split("="),r[n[0].trim()]=n[1];return r},e.writeFmtp=function(t){let r="",n=t.payloadType;if(t.preferredPayloadType!==void 0&&(n=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const i=[];Object.keys(t.parameters).forEach(o=>{t.parameters[o]!==void 0?i.push(o+"="+t.parameters[o]):i.push(o)}),r+="a=fmtp:"+n+" "+i.join(";")+`\r
`}return r},e.parseRtcpFb=function(t){const r=t.substring(t.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(t){let r="",n=t.payloadType;return t.preferredPayloadType!==void 0&&(n=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(i=>{r+="a=rtcp-fb:"+n+" "+i.type+(i.parameter&&i.parameter.length?" "+i.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(t){const r=t.indexOf(" "),n={ssrc:parseInt(t.substring(7,r),10)},i=t.indexOf(":",r);return i>-1?(n.attribute=t.substring(r+1,i),n.value=t.substring(i+1)):n.attribute=t.substring(r+1),n},e.parseSsrcGroup=function(t){const r=t.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(n=>parseInt(n,10))}},e.getMid=function(t){const r=e.matchPrefix(t,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(t){const r=t.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(t,r){return{role:"auto",fingerprints:e.matchPrefix(t+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,r){let n="a=setup:"+r+`\r
`;return t.fingerprints.forEach(i=>{n+="a=fingerprint:"+i.algorithm+" "+i.value+`\r
`}),n},e.parseCryptoLine=function(t){const r=t.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const r=t.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,r){return e.matchPrefix(t+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(t,r){const n=e.matchPrefix(t+r,"a=ice-ufrag:")[0],i=e.matchPrefix(t+r,"a=ice-pwd:")[0];return n&&i?{usernameFragment:n.substring(12),password:i.substring(10)}:null},e.writeIceParameters=function(t){let r="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(t){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=e.splitLines(t)[0].split(" ");r.profile=i[2];for(let c=3;c<i.length;c++){const d=i[c],u=e.matchPrefix(t,"a=rtpmap:"+d+" ")[0];if(u){const p=e.parseRtpMap(u),l=e.matchPrefix(t,"a=fmtp:"+d+" ");switch(p.parameters=l.length?e.parseFmtp(l[0]):{},p.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+d+" ").map(e.parseRtcpFb),r.codecs.push(p),p.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(p.name.toUpperCase());break}}}e.matchPrefix(t,"a=extmap:").forEach(c=>{r.headerExtensions.push(e.parseExtmap(c))});const o=e.matchPrefix(t,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(c=>{o.forEach(d=>{c.rtcpFeedback.find(p=>p.type===d.type&&p.parameter===d.parameter)||c.rtcpFeedback.push(d)})}),r},e.writeRtpDescription=function(t,r){let n="";n+="m="+t+" ",n+=r.codecs.length>0?"9":"0",n+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",n+=r.codecs.map(o=>o.preferredPayloadType!==void 0?o.preferredPayloadType:o.payloadType).join(" ")+`\r
`,n+=`c=IN IP4 0.0.0.0\r
`,n+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(o=>{n+=e.writeRtpMap(o),n+=e.writeFmtp(o),n+=e.writeRtcpFb(o)});let i=0;return r.codecs.forEach(o=>{o.maxptime>i&&(i=o.maxptime)}),i>0&&(n+="a=maxptime:"+i+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(o=>{n+=e.writeExtmap(o)}),n},e.parseRtpEncodingParameters=function(t){const r=[],n=e.parseRtpParameters(t),i=n.fecMechanisms.indexOf("RED")!==-1,o=n.fecMechanisms.indexOf("ULPFEC")!==-1,c=e.matchPrefix(t,"a=ssrc:").map(h=>e.parseSsrcMedia(h)).filter(h=>h.attribute==="cname"),d=c.length>0&&c[0].ssrc;let u;const p=e.matchPrefix(t,"a=ssrc-group:FID").map(h=>h.substring(17).split(" ").map(m=>parseInt(m,10)));p.length>0&&p[0].length>1&&p[0][0]===d&&(u=p[0][1]),n.codecs.forEach(h=>{if(h.name.toUpperCase()==="RTX"&&h.parameters.apt){let _={ssrc:d,codecPayloadType:parseInt(h.parameters.apt,10)};d&&u&&(_.rtx={ssrc:u}),r.push(_),i&&(_=JSON.parse(JSON.stringify(_)),_.fec={ssrc:d,mechanism:o?"red+ulpfec":"red"},r.push(_))}}),r.length===0&&d&&r.push({ssrc:d});let l=e.matchPrefix(t,"b=");return l.length&&(l[0].indexOf("b=TIAS:")===0?l=parseInt(l[0].substring(7),10):l[0].indexOf("b=AS:")===0?l=parseInt(l[0].substring(5),10)*1e3*.95-2e3*8:l=void 0,r.forEach(h=>{h.maxBitrate=l})),r},e.parseRtcpParameters=function(t){const r={},n=e.matchPrefix(t,"a=ssrc:").map(c=>e.parseSsrcMedia(c)).filter(c=>c.attribute==="cname")[0];n&&(r.cname=n.value,r.ssrc=n.ssrc);const i=e.matchPrefix(t,"a=rtcp-rsize");r.reducedSize=i.length>0,r.compound=i.length===0;const o=e.matchPrefix(t,"a=rtcp-mux");return r.mux=o.length>0,r},e.writeRtcpParameters=function(t){let r="";return t.reducedSize&&(r+=`a=rtcp-rsize\r
`),t.mux&&(r+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(r+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),r},e.parseMsid=function(t){let r;const n=e.matchPrefix(t,"a=msid:");if(n.length===1)return r=n[0].substring(7).split(" "),{stream:r[0],track:r[1]};const i=e.matchPrefix(t,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="msid");if(i.length>0)return r=i[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(t){const r=e.parseMLine(t),n=e.matchPrefix(t,"a=max-message-size:");let i;n.length>0&&(i=parseInt(n[0].substring(19),10)),isNaN(i)&&(i=65536);const o=e.matchPrefix(t,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:r.fmt,maxMessageSize:i};const c=e.matchPrefix(t,"a=sctpmap:");if(c.length>0){const d=c[0].substring(10).split(" ");return{port:parseInt(d[0],10),protocol:d[1],maxMessageSize:i}}},e.writeSctpDescription=function(t,r){let n=[];return t.protocol!=="DTLS/SCTP"?n=["m="+t.kind+" 9 "+t.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:n=["m="+t.kind+" 9 "+t.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&n.push("a=max-message-size:"+r.maxMessageSize+`\r
`),n.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(t,r,n){let i;const o=r!==void 0?r:2;return t?i=t:i=e.generateSessionId(),`v=0\r
o=`+(n||"thisisadapterortc")+" "+i+" "+o+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(t,r){const n=e.splitLines(t);for(let i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(t){return e.splitLines(t)[0].split(" ")[0].substring(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){const n=e.splitLines(t)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},e.parseOLine=function(t){const n=e.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const r=e.splitLines(t);for(let n=0;n<r.length;n++)if(r[n].length<2||r[n].charAt(1)!=="=")return!1;return!0},s.exports=e})(ee)),ee.exports}var ft=Bt();const F=Ie(ft),Ht=Pt({__proto__:null,default:F},[ft]);function q(s){if(!s.RTCIceCandidate||s.RTCIceCandidate&&"foundation"in s.RTCIceCandidate.prototype)return;const e=s.RTCIceCandidate;s.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const n=new e(r),i=F.parseCandidate(r.candidate);for(const o in i)o in n||Object.defineProperty(n,o,{value:i[o]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new e(r)},s.RTCIceCandidate.prototype=e.prototype,O(s,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new s.RTCIceCandidate(t.candidate),writable:"false"}),t))}function oe(s){!s.RTCIceCandidate||s.RTCIceCandidate&&"relayProtocol"in s.RTCIceCandidate.prototype||O(s,"icecandidate",e=>{if(e.candidate){const t=F.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function Y(s,e){if(!s.RTCPeerConnection)return;"sctp"in s.RTCPeerConnection.prototype||Object.defineProperty(s.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(c){if(!c||!c.sdp)return!1;const d=F.splitSections(c.sdp);return d.shift(),d.some(u=>{const p=F.parseMLine(u);return p&&p.kind==="application"&&p.protocol.indexOf("SCTP")!==-1})},r=function(c){const d=c.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(d===null||d.length<2)return-1;const u=parseInt(d[1],10);return u!==u?-1:u},n=function(c){let d=65536;return e.browser==="firefox"&&(e.version<57?c===-1?d=16384:d=2147483637:e.version<60?d=e.version===57?65535:65536:d=2147483637),d},i=function(c,d){let u=65536;e.browser==="firefox"&&e.version===57&&(u=65535);const p=F.matchPrefix(c.sdp,"a=max-message-size:");return p.length>0?u=parseInt(p[0].substring(19),10):e.browser==="firefox"&&d!==-1&&(u=2147483637),u},o=s.RTCPeerConnection.prototype.setRemoteDescription;s.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:d}=this.getConfiguration();d==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const d=r(arguments[0]),u=n(d),p=i(arguments[0],d);let l;u===0&&p===0?l=Number.POSITIVE_INFINITY:u===0||p===0?l=Math.max(u,p):l=Math.min(u,p);const h={};Object.defineProperty(h,"maxMessageSize",{get(){return l}}),this._sctp=h}return o.apply(this,arguments)}}function w(s){if(!(s.RTCPeerConnection&&"createDataChannel"in s.RTCPeerConnection.prototype))return;function e(r,n){const i=r.send;r.send=function(){const c=arguments[0],d=c.length||c.size||c.byteLength;if(r.readyState==="open"&&n.sctp&&d>n.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)");return i.apply(r,arguments)}}const t=s.RTCPeerConnection.prototype.createDataChannel;s.RTCPeerConnection.prototype.createDataChannel=function(){const n=t.apply(this,arguments);return e(n,this),n},O(s,"datachannel",r=>(e(r.channel,r.target),r))}function ce(s){if(!s.RTCPeerConnection||"connectionState"in s.RTCPeerConnection.prototype)return;const e=s.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const r=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=n=>{const i=n.target;if(i._lastConnectionState!==i.connectionState){i._lastConnectionState=i.connectionState;const o=new Event("connectionstatechange",n);i.dispatchEvent(o)}return n},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function de(s,e){if(!s.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const t=s.RTCPeerConnection.prototype.setRemoteDescription;s.RTCPeerConnection.prototype.setRemoteDescription=function(n){if(n&&n.sdp&&n.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const i=n.sdp.split(`
`).filter(o=>o.trim()!=="a=extmap-allow-mixed").join(`
`);s.RTCSessionDescription&&n instanceof s.RTCSessionDescription?arguments[0]=new s.RTCSessionDescription({type:n.type,sdp:i}):n.sdp=i}return t.apply(this,arguments)}}function W(s,e){if(!(s.RTCPeerConnection&&s.RTCPeerConnection.prototype))return;const t=s.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(s.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function V(s,e){if(!(s.RTCPeerConnection&&s.RTCPeerConnection.prototype))return;const t=s.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(s.RTCPeerConnection.prototype.setLocalDescription=function(){let n=arguments[0]||{};if(typeof n!="object"||n.type&&n.sdp)return t.apply(this,arguments);if(n={type:n.type,sdp:n.sdp},!n.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":n.type="offer";break;default:n.type="answer";break}return n.sdp||n.type!=="offer"&&n.type!=="answer"?t.apply(this,[n]):(n.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(o=>t.apply(this,[o]))})}const qt=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:de,shimAddIceCandidateNullOrEmpty:W,shimConnectionState:ce,shimMaxMessageSize:Y,shimParameterlessSetLocalDescription:V,shimRTCIceCandidate:q,shimRTCIceCandidateRelayProtocol:oe,shimSendThrowTypeError:w},Symbol.toStringTag,{value:"Module"}));function Yt({window:s}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const t=Ue,r=Gt(s),n={browserDetails:r,commonShim:qt,extractVersion:B,disableLog:Ft,disableWarnings:Ut,sdp:Ht};switch(r.browser){case"chrome":if(!Ee||!ae||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),n;if(r.version===null)return t("Chrome shim can not determine version, not shimming."),n;t("adapter.js shimming chrome."),n.browserShim=Ee,W(s,r),V(s),ze(s,r),Be(s),ae(s,r),He(s),We(s,r),qe(s),Ye(s),Ve(s,r),q(s),oe(s),ce(s),Y(s,r),w(s),de(s,r);break;case"firefox":if(!Te||!ie||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),n;t("adapter.js shimming firefox."),n.browserShim=Te,W(s,r),V(s),Je(s,r),ie(s,r),Qe(s),Ze(s),Ke(s),Xe(s),et(s),tt(s),rt(s),st(s),nt(s),q(s),ce(s),Y(s,r),w(s);break;case"safari":if(!Re||!e.shimSafari)return t("Safari shim is not included in this adapter release."),n;t("adapter.js shimming safari."),n.browserShim=Re,W(s,r),V(s),lt(s),pt(s),ot(s),at(s),it(s),ut(s),ct(s),ht(s),q(s),oe(s),Y(s,r),w(s),de(s,r);break;default:t("Unsupported browser!");break}return n}const je=Yt({window:typeof window>"u"?void 0:window});function M(s,e,t,r){Object.defineProperty(s,e,{get:t,set:r,enumerable:!0,configurable:!0})}class mt{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=e=>{const t=[],r=e.byteLength,n=Math.ceil(r/this.chunkedMTU);let i=0,o=0;for(;o<r;){const c=Math.min(r,o+this.chunkedMTU),d=e.slice(o,c),u={__peerData:this._dataCount,n:i,data:d,total:n};t.push(u),o=c,i++}return this._dataCount++,t}}}function wt(s){let e=0;for(const n of s)e+=n.byteLength;const t=new Uint8Array(e);let r=0;for(const n of s)t.set(n,r),r+=n.byteLength;return t}const te=je.default||je,z=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const s=this.getBrowser(),e=this.getVersion();return this.supportedBrowsers.includes(s)?s==="chrome"?e>=this.minChromeVersion:s==="firefox"?e>=this.minFirefoxVersion:s==="safari"?!this.isIOS&&e>=this.minSafariVersion:!1:!1}getBrowser(){return te.browserDetails.browser}getVersion(){return te.browserDetails.version||0}isUnifiedPlanSupported(){const s=this.getBrowser(),e=te.browserDetails.version||0;if(s==="chrome"&&e<this.minChromeVersion)return!1;if(s==="firefox"&&e>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let t,r=!1;try{t=new RTCPeerConnection,t.addTransceiver("audio"),r=!0}catch{}finally{t&&t.close()}return r}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=typeof navigator<"u"?["iPad","iPhone","iPod"].includes(navigator.platform):!1,this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},Wt=s=>!s||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(s),_t=()=>Math.random().toString(36).slice(2),Ne={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class Vt extends mt{noop(){}blobToArrayBuffer(e,t){const r=new FileReader;return r.onload=function(n){n.target&&t(n.target.result)},r.readAsArrayBuffer(e),r}binaryStringToArrayBuffer(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r)&255;return t.buffer}isSecure(){return location.protocol==="https:"}constructor(...e){super(...e),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=Ne,this.browser=z.getBrowser(),this.browserVersion=z.getVersion(),this.pack=Le,this.unpack=Me,this.supports=(function(){const t={browser:z.isBrowserSupported(),webRTC:z.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;let r;try{r=new RTCPeerConnection(Ne),t.audioVideo=!0;let n;try{n=r.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!n.ordered;try{n.binaryType="blob",t.binaryBlob=!z.isIOS}catch{}}catch{}finally{n&&n.close()}}catch{}finally{r&&r.close()}return t})(),this.validateId=Wt,this.randomToken=_t}}const A=new Vt,Jt="PeerJS: ";class Qt{get logLevel(){return this._logLevel}set logLevel(e){this._logLevel=e}log(...e){this._logLevel>=3&&this._print(3,...e)}warn(...e){this._logLevel>=2&&this._print(2,...e)}error(...e){this._logLevel>=1&&this._print(1,...e)}setLogFunction(e){this._print=e}_print(e,...t){const r=[Jt,...t];for(const n in r)r[n]instanceof Error&&(r[n]="("+r[n].name+") "+r[n].message);e>=3?console.log(...r):e>=2?console.warn("WARNING",...r):e>=1&&console.error("ERROR",...r)}constructor(){this._logLevel=0}}var g=new Qt,pe={},Kt=Object.prototype.hasOwnProperty,N="~";function H(){}Object.create&&(H.prototype=Object.create(null),new H().__proto__||(N=!1));function Xt(s,e,t){this.fn=s,this.context=e,this.once=t||!1}function gt(s,e,t,r,n){if(typeof t!="function")throw new TypeError("The listener must be a function");var i=new Xt(t,r||s,n),o=N?N+e:e;return s._events[o]?s._events[o].fn?s._events[o]=[s._events[o],i]:s._events[o].push(i):(s._events[o]=i,s._eventsCount++),s}function J(s,e){--s._eventsCount===0?s._events=new H:delete s._events[e]}function P(){this._events=new H,this._eventsCount=0}P.prototype.eventNames=function(){var e=[],t,r;if(this._eventsCount===0)return e;for(r in t=this._events)Kt.call(t,r)&&e.push(N?r.slice(1):r);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};P.prototype.listeners=function(e){var t=N?N+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,i=r.length,o=new Array(i);n<i;n++)o[n]=r[n].fn;return o};P.prototype.listenerCount=function(e){var t=N?N+e:e,r=this._events[t];return r?r.fn?1:r.length:0};P.prototype.emit=function(e,t,r,n,i,o){var c=N?N+e:e;if(!this._events[c])return!1;var d=this._events[c],u=arguments.length,p,l;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),u){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,r),!0;case 4:return d.fn.call(d.context,t,r,n),!0;case 5:return d.fn.call(d.context,t,r,n,i),!0;case 6:return d.fn.call(d.context,t,r,n,i,o),!0}for(l=1,p=new Array(u-1);l<u;l++)p[l-1]=arguments[l];d.fn.apply(d.context,p)}else{var h=d.length,_;for(l=0;l<h;l++)switch(d[l].once&&this.removeListener(e,d[l].fn,void 0,!0),u){case 1:d[l].fn.call(d[l].context);break;case 2:d[l].fn.call(d[l].context,t);break;case 3:d[l].fn.call(d[l].context,t,r);break;case 4:d[l].fn.call(d[l].context,t,r,n);break;default:if(!p)for(_=1,p=new Array(u-1);_<u;_++)p[_-1]=arguments[_];d[l].fn.apply(d[l].context,p)}}return!0};P.prototype.on=function(e,t,r){return gt(this,e,t,r,!1)};P.prototype.once=function(e,t,r){return gt(this,e,t,r,!0)};P.prototype.removeListener=function(e,t,r,n){var i=N?N+e:e;if(!this._events[i])return this;if(!t)return J(this,i),this;var o=this._events[i];if(o.fn)o.fn===t&&(!n||o.once)&&(!r||o.context===r)&&J(this,i);else{for(var c=0,d=[],u=o.length;c<u;c++)(o[c].fn!==t||n&&!o[c].once||r&&o[c].context!==r)&&d.push(o[c]);d.length?this._events[i]=d.length===1?d[0]:d:J(this,i)}return this};P.prototype.removeAllListeners=function(e){var t;return e?(t=N?N+e:e,this._events[t]&&J(this,t)):(this._events=new H,this._eventsCount=0),this};P.prototype.off=P.prototype.removeListener;P.prototype.addListener=P.prototype.on;P.prefixed=N;P.EventEmitter=P;pe=P;var L={};M(L,"ConnectionType",()=>I);M(L,"PeerErrorType",()=>T);M(L,"BaseConnectionErrorType",()=>le);M(L,"DataConnectionErrorType",()=>he);M(L,"SerializationType",()=>X);M(L,"SocketEventType",()=>k);M(L,"ServerMessageType",()=>R);var I=(function(s){return s.Data="data",s.Media="media",s})({}),T=(function(s){return s.BrowserIncompatible="browser-incompatible",s.Disconnected="disconnected",s.InvalidID="invalid-id",s.InvalidKey="invalid-key",s.Network="network",s.PeerUnavailable="peer-unavailable",s.SslUnavailable="ssl-unavailable",s.ServerError="server-error",s.SocketError="socket-error",s.SocketClosed="socket-closed",s.UnavailableID="unavailable-id",s.WebRTC="webrtc",s})({}),le=(function(s){return s.NegotiationFailed="negotiation-failed",s.ConnectionClosed="connection-closed",s})({}),he=(function(s){return s.NotOpenYet="not-open-yet",s.MessageToBig="message-too-big",s})({}),X=(function(s){return s.Binary="binary",s.BinaryUTF8="binary-utf8",s.JSON="json",s.None="raw",s})({}),k=(function(s){return s.Message="message",s.Disconnected="disconnected",s.Error="error",s.Close="close",s})({}),R=(function(s){return s.Heartbeat="HEARTBEAT",s.Candidate="CANDIDATE",s.Offer="OFFER",s.Answer="ANSWER",s.Open="OPEN",s.Error="ERROR",s.IdTaken="ID-TAKEN",s.InvalidKey="INVALID-KEY",s.Leave="LEAVE",s.Expire="EXPIRE",s})({});const yt="1.5.5";class Zt extends pe.EventEmitter{constructor(e,t,r,n,i,o=5e3){super(),this.pingInterval=o,this._disconnected=!0,this._messagesQueue=[];const c=e?"wss://":"ws://";this._baseUrl=c+t+":"+r+n+"peerjs?key="+i}start(e,t){this._id=e;const r=`${this._baseUrl}&id=${e}&token=${t}`;this._socket||!this._disconnected||(this._socket=new WebSocket(r+"&version="+yt),this._disconnected=!1,this._socket.onmessage=n=>{let i;try{i=JSON.parse(n.data),g.log("Server message received:",i)}catch{g.log("Invalid server message",n.data);return}this.emit(k.Message,i)},this._socket.onclose=n=>{this._disconnected||(g.log("Socket closed.",n),this._cleanup(),this._disconnected=!0,this.emit(k.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),g.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){g.log("Cannot send heartbeat, because socket closed");return}const e=JSON.stringify({type:R.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const e=[...this._messagesQueue];this._messagesQueue=[];for(const t of e)this.send(t)}send(e){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(e);return}if(!e.type){this.emit(k.Error,"Invalid message");return}if(!this._wsOpen())return;const t=JSON.stringify(e);this._socket.send(t)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class Ct{constructor(e){this.connection=e}startConnection(e){const t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===I.Media&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){const r=this.connection,n={ordered:!!e.reliable},i=t.createDataChannel(r.label,n);r._initializeDataChannel(i),this._makeOffer()}else this.handleSDP("OFFER",e.sdp)}_startPeerConnection(){g.log("Creating RTCPeerConnection.");const e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e}_setupListeners(e){const t=this.connection.peer,r=this.connection.connectionId,n=this.connection.type,i=this.connection.provider;g.log("Listening for ICE candidates."),e.onicecandidate=o=>{!o.candidate||!o.candidate.candidate||(g.log(`Received ICE candidates for ${t}:`,o.candidate),i.socket.send({type:R.Candidate,payload:{candidate:o.candidate,type:n,connectionId:r},dst:t}))},e.oniceconnectionstatechange=()=>{switch(e.iceConnectionState){case"failed":g.log("iceConnectionState is failed, closing connections to "+t),this.connection.emitError(le.NegotiationFailed,"Negotiation of connection to "+t+" failed."),this.connection.close();break;case"closed":g.log("iceConnectionState is closed, closing connections to "+t),this.connection.emitError(le.ConnectionClosed,"Connection to "+t+" closed."),this.connection.close();break;case"disconnected":g.log("iceConnectionState changed to disconnected on the connection with "+t);break;case"completed":e.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",e.iceConnectionState)},g.log("Listening for data channel"),e.ondatachannel=o=>{g.log("Received data channel");const c=o.channel;i.getConnection(t,r)._initializeDataChannel(c)},g.log("Listening for remote stream"),e.ontrack=o=>{g.log("Received remote stream");const c=o.streams[0],d=i.getConnection(t,r);if(d.type===I.Media){const u=d;this._addStreamToMediaConnection(c,u)}}}cleanup(){g.log("Cleaning up PeerConnection to "+this.connection.peer);const e=this.connection.peerConnection;if(!e)return;this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=()=>{};const t=e.signalingState!=="closed";let r=!1;const n=this.connection.dataChannel;n&&(r=!!n.readyState&&n.readyState!=="closed"),(t||r)&&e.close()}async _makeOffer(){const e=this.connection.peerConnection,t=this.connection.provider;try{const r=await e.createOffer(this.connection.options.constraints);g.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp);try{await e.setLocalDescription(r),g.log("Set localDescription:",r,`for:${this.connection.peer}`);let n={sdp:r,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===I.Data){const i=this.connection;n={...n,label:i.label,reliable:i.reliable,serialization:i.serialization}}t.socket.send({type:R.Offer,payload:n,dst:this.connection.peer})}catch(n){n!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(t.emitError(T.WebRTC,n),g.log("Failed to setLocalDescription, ",n))}}catch(r){t.emitError(T.WebRTC,r),g.log("Failed to createOffer, ",r)}}async _makeAnswer(){const e=this.connection.peerConnection,t=this.connection.provider;try{const r=await e.createAnswer();g.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp);try{await e.setLocalDescription(r),g.log("Set localDescription:",r,`for:${this.connection.peer}`),t.socket.send({type:R.Answer,payload:{sdp:r,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(n){t.emitError(T.WebRTC,n),g.log("Failed to setLocalDescription, ",n)}}catch(r){t.emitError(T.WebRTC,r),g.log("Failed to create answer, ",r)}}async handleSDP(e,t){t=new RTCSessionDescription(t);const r=this.connection.peerConnection,n=this.connection.provider;g.log("Setting remote description",t);const i=this;try{await r.setRemoteDescription(t),g.log(`Set remoteDescription:${e} for:${this.connection.peer}`),e==="OFFER"&&await i._makeAnswer()}catch(o){n.emitError(T.WebRTC,o),g.log("Failed to setRemoteDescription, ",o)}}async handleCandidate(e){g.log("handleCandidate:",e);try{await this.connection.peerConnection.addIceCandidate(e),g.log(`Added ICE candidate for:${this.connection.peer}`)}catch(t){this.connection.provider.emitError(T.WebRTC,t),g.log("Failed to handleCandidate, ",t)}}_addTracksToConnection(e,t){if(g.log(`add tracks from stream ${e.id} to peer connection`),!t.addTrack)return g.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(r=>{t.addTrack(r,e)})}_addStreamToMediaConnection(e,t){g.log(`add stream ${e.id} to media connection ${t.connectionId}`),t.addStream(e)}}class vt extends pe.EventEmitter{emitError(e,t){g.error("Error:",t),this.emit("error",new er(`${e}`,t))}}class er extends Error{constructor(e,t){typeof t=="string"?super(t):(super(),Object.assign(this,t)),this.type=e}}class St extends vt{get open(){return this._open}constructor(e,t,r){super(),this.peer=e,this.provider=t,this.options=r,this._open=!1,this.metadata=r.metadata}}class Q extends St{static#e=this.ID_PREFIX="mc_";get type(){return I.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(e,t,r){super(e,t,r),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||Q.ID_PREFIX+A.randomToken(),this._negotiator=new Ct(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{g.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{g.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(e){g.log("Receiving stream",e),this._remoteStream=e,super.emit("stream",e)}handleMessage(e){const t=e.type,r=e.payload;switch(e.type){case R.Answer:this._negotiator.handleSDP(t,r.sdp),this._open=!0;break;case R.Candidate:this._negotiator.handleCandidate(r.candidate);break;default:g.warn(`Unrecognized message type:${t} from peer:${this.peer}`);break}}answer(e,t={}){if(this._localStream){g.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:e});const r=this.provider._getMessages(this.connectionId);for(const n of r)this.handleMessage(n);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}}class tr{constructor(e){this._options=e}_buildRequest(e){const t=this._options.secure?"https":"http",{host:r,port:n,path:i,key:o}=this._options,c=new URL(`${t}://${r}:${n}${i}${o}/${e}`);return c.searchParams.set("ts",`${Date.now()}${Math.random()}`),c.searchParams.set("version",yt),fetch(c.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const e=await this._buildRequest("id");if(e.status!==200)throw new Error(`Error. Status:${e.status}`);return e.text()}catch(e){g.error("Error retrieving ID",e);let t="";throw this._options.path==="/"&&this._options.host!==A.CLOUD_HOST&&(t=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+t)}}async listAllPeers(){try{const e=await this._buildRequest("peers");if(e.status!==200){if(e.status===401){let t="";throw this._options.host===A.CLOUD_HOST?t="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":t="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+t)}throw new Error(`Error. Status:${e.status}`)}return e.json()}catch(e){throw g.error("Error retrieving list peers",e),new Error("Could not get list peers from the server."+e)}}}class K extends St{static#e=this.ID_PREFIX="dc_";static#t=this.MAX_BUFFERED_AMOUNT=8388608;get type(){return I.Data}constructor(e,t,r){super(e,t,r),this.connectionId=this.options.connectionId||K.ID_PREFIX+_t(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new Ct(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{g.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=t=>{g.log(`DC#${this.connectionId} dc onmessage:`,t.data)},this.dataChannel.onclose=()=>{g.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(e){if(e?.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(e,t=!1){if(!this.open){this.emitError(he.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(e,t)}async handleMessage(e){const t=e.payload;switch(e.type){case R.Answer:await this._negotiator.handleSDP(e.type,t.sdp);break;case R.Candidate:await this._negotiator.handleCandidate(t.candidate);break;default:g.warn("Unrecognized message type:",e.type,"from peer:",this.peer);break}}}class fe extends K{get bufferSize(){return this._bufferSize}_initializeDataChannel(e){super._initializeDataChannel(e),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",t=>this._handleDataMessage(t))}_bufferedSend(e){(this._buffering||!this._trySend(e))&&(this._buffer.push(e),this._bufferSize=this._buffer.length)}_trySend(e){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>K.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(t){return g.error(`DC#:${this.connectionId} Error when sending:`,t),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(e){if(e?.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...e){super(...e),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class re extends fe{close(e){super.close(e),this._chunkedData={}}constructor(e,t,r){super(e,t,r),this.chunker=new mt,this.serialization=X.Binary,this._chunkedData={}}_handleDataMessage({data:e}){const t=Me(e),r=t.__peerData;if(r){if(r.type==="close"){this.close();return}this._handleChunk(t);return}this.emit("data",t)}_handleChunk(e){const t=e.__peerData,r=this._chunkedData[t]||{data:[],count:0,total:e.total};if(r.data[e.n]=new Uint8Array(e.data),r.count++,this._chunkedData[t]=r,r.total===r.count){delete this._chunkedData[t];const n=wt(r.data);this._handleDataMessage({data:n})}}_send(e,t){const r=Le(e);if(r instanceof Promise)return this._send_blob(r);if(!t&&r.byteLength>this.chunker.chunkedMTU){this._sendChunks(r);return}this._bufferedSend(r)}async _send_blob(e){const t=await e;if(t.byteLength>this.chunker.chunkedMTU){this._sendChunks(t);return}this._bufferedSend(t)}_sendChunks(e){const t=this.chunker.chunk(e);g.log(`DC#${this.connectionId} Try to send ${t.length} chunks...`);for(const r of t)this.send(r,!0)}}class rr extends fe{_handleDataMessage({data:e}){super.emit("data",e)}_send(e,t){this._bufferedSend(e)}constructor(...e){super(...e),this.serialization=X.None}}class sr extends fe{_handleDataMessage({data:e}){const t=this.parse(this.decoder.decode(e)),r=t.__peerData;if(r&&r.type==="close"){this.close();return}this.emit("data",t)}_send(e,t){const r=this.encoder.encode(this.stringify(e));if(r.byteLength>=A.chunkedMTU){this.emitError(he.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(r)}constructor(...e){super(...e),this.serialization=X.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}class me extends vt{static#e=this.DEFAULT_KEY="peerjs";get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const e=Object.create(null);for(const[t,r]of this._connections)e[t]=r;return e}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(e,t){super(),this._serializers={raw:rr,json:sr,binary:re,"binary-utf8":re,default:re},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let r;if(e&&e.constructor==Object?t=e:e&&(r=e.toString()),t={debug:0,host:A.CLOUD_HOST,port:A.CLOUD_PORT,path:"/",key:me.DEFAULT_KEY,token:A.randomToken(),config:A.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...t},this._options=t,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==A.CLOUD_HOST?this._options.secure=A.isSecure():this._options.host==A.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&g.setLogFunction(this._options.logFunction),g.logLevel=this._options.debug||0,this._api=new tr(t),this._socket=this._createServerConnection(),!A.supports.audioVideo&&!A.supports.data){this._delayedAbort(T.BrowserIncompatible,"The current browser does not support WebRTC");return}if(r&&!A.validateId(r)){this._delayedAbort(T.InvalidID,`ID "${r}" is invalid`);return}r?this._initialize(r):this._api.retrieveId().then(n=>this._initialize(n)).catch(n=>this._abort(T.ServerError,n))}_createServerConnection(){const e=new Zt(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(k.Message,t=>{this._handleMessage(t)}),e.on(k.Error,t=>{this._abort(T.SocketError,t)}),e.on(k.Disconnected,()=>{this.disconnected||(this.emitError(T.Network,"Lost connection to server."),this.disconnect())}),e.on(k.Close,()=>{this.disconnected||this._abort(T.SocketClosed,"Underlying socket is already closed.")}),e}_initialize(e){this._id=e,this.socket.start(e,this._options.token)}_handleMessage(e){const t=e.type,r=e.payload,n=e.src;switch(t){case R.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case R.Error:this._abort(T.ServerError,r.msg);break;case R.IdTaken:this._abort(T.UnavailableID,`ID "${this.id}" is taken`);break;case R.InvalidKey:this._abort(T.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case R.Leave:g.log(`Received leave message from ${n}`),this._cleanupPeer(n),this._connections.delete(n);break;case R.Expire:this.emitError(T.PeerUnavailable,`Could not connect to peer ${n}`);break;case R.Offer:{const i=r.connectionId;let o=this.getConnection(n,i);if(o&&(o.close(),g.warn(`Offer received for existing Connection ID:${i}`)),r.type===I.Media){const d=new Q(n,this,{connectionId:i,_payload:r,metadata:r.metadata});o=d,this._addConnection(n,o),this.emit("call",d)}else if(r.type===I.Data){const d=new this._serializers[r.serialization](n,this,{connectionId:i,_payload:r,metadata:r.metadata,label:r.label,serialization:r.serialization,reliable:r.reliable});o=d,this._addConnection(n,o),this.emit("connection",d)}else{g.warn(`Received malformed connection type:${r.type}`);return}const c=this._getMessages(i);for(const d of c)o.handleMessage(d);break}default:{if(!r){g.warn(`You received a malformed message from ${n} of type ${t}`);return}const i=r.connectionId,o=this.getConnection(n,i);o&&o.peerConnection?o.handleMessage(e):i?this._storeMessage(i,e):g.warn("You received an unrecognized message:",e);break}}}_storeMessage(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)}_getMessages(e){const t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]}connect(e,t={}){if(t={serialization:"default",...t},this.disconnected){g.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(T.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const r=new this._serializers[t.serialization](e,this,t);return this._addConnection(e,r),r}call(e,t,r={}){if(this.disconnected){g.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(T.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!t){g.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const n=new Q(e,this,{...r,_stream:t});return this._addConnection(e,n),n}_addConnection(e,t){g.log(`add connection ${t.type}:${t.connectionId} to peerId:${e}`),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)}_removeConnection(e){const t=this._connections.get(e.peer);if(t){const r=t.indexOf(e);r!==-1&&t.splice(r,1)}this._lostMessages.delete(e.connectionId)}getConnection(e,t){const r=this._connections.get(e);if(!r)return null;for(const n of r)if(n.connectionId===t)return n;return null}_delayedAbort(e,t){setTimeout(()=>{this._abort(e,t)},0)}_abort(e,t){g.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(g.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const e of this._connections.keys())this._cleanupPeer(e),this._connections.delete(e);this.socket.removeAllListeners()}_cleanupPeer(e){const t=this._connections.get(e);if(t)for(const r of t)r.close()}disconnect(){if(this.disconnected)return;const e=this.id;g.log(`Disconnect peer with ID:${e}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit("disconnected",e)}reconnect(){if(this.disconnected&&!this.destroyed)g.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)g.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(e=t=>{}){this._api.listAllPeers().then(t=>e(t)).catch(t=>this._abort(T.ServerError,t))}}var Ae=me;class nr{constructor(){this.peer=null,this.connections=new Map,this.onMessageCallbacks=[],this.roomCode=null,this.isHost=!1}initializeAsHost(e){return new Promise((t,r)=>{try{this.roomCode=e,this.isHost=!0,this.peer=new Ae(`fdp-host-${e}`,{debug:2,config:{iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]}}),this.peer.on("open",n=>{console.log("🎮 Host peer aberto com ID:",n),t(n)}),this.peer.on("error",n=>{console.error("❌ Erro no peer host:",n),r(n)}),this.peer.on("connection",n=>{console.log("👥 Novo jogador conectando:",n.peer),this.setupConnection(n)})}catch(n){r(n)}})}connectToRoom(e){return new Promise((t,r)=>{try{this.roomCode=e,this.isHost=!1,this.peer=new Ae(`fdp-player-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,{debug:2,config:{iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]}}),this.peer.on("open",n=>{console.log("🎮 Player peer aberto com ID:",n);const i=`fdp-host-${e}`;console.log("🔌 Conectando ao host:",i);const o=this.peer.connect(i,{reliable:!0,serialization:"json"});this.setupConnection(o),o.on("open",()=>{console.log("✅ Conectado ao host com sucesso!"),t(n)}),o.on("error",c=>{console.error("❌ Erro ao conectar ao host:",c),r(c)})}),this.peer.on("error",n=>{console.error("❌ Erro no peer player:",n),r(n)})}catch(n){r(n)}})}setupConnection(e){e.on("open",()=>{console.log("🔗 Conexão estabelecida com:",e.peer),this.connections.set(e.peer,e)}),e.on("data",t=>{console.log("📨 Mensagem recebida:",t),this.onMessageCallbacks.forEach(r=>r(t)),this.isHost&&this.broadcast(t,e.peer)}),e.on("close",()=>{console.log("👋 Conexão fechada com:",e.peer),this.connections.delete(e.peer)}),e.on("error",t=>{console.error("❌ Erro na conexão com",e.peer,":",t)})}broadcast(e,t=null){const r=typeof e=="string"?e:JSON.stringify(e);this.connections.forEach((n,i)=>{if(i!==t&&n.open)try{n.send(r)}catch(o){console.error("❌ Erro ao enviar para",i,":",o)}})}onMessage(e){this.onMessageCallbacks.push(e)}removeMessageListener(e){const t=this.onMessageCallbacks.indexOf(e);t>-1&&this.onMessageCallbacks.splice(t,1)}disconnect(){console.log("🔌 Desconectando peer service..."),this.connections.forEach(e=>{e.close()}),this.connections.clear(),this.peer&&(this.peer.destroy(),this.peer=null),this.onMessageCallbacks=[]}isConnected(){return this.peer&&!this.peer.destroyed&&this.connections.size>0}getConnectionCount(){return this.connections.size}}const D=new nr;function xt(s,e){if(!s||!e)return 0;const t=s.toLowerCase(),r=e.toLowerCase();let n=30;const i=["cu","buceta","pau","merda","porra","caralho","fodendo","bosta","peido","mijando","cagando","bêbado","drogado","viado","puta","vagabundo"],o=["fazer","comendo","bebendo","dançando","cantando","pulando","correndo","gritando","chorando","rindo"],c=["dildo","garrafa","pepino","banana","melancia","salsicha","linguiça"];let d=0;return i.forEach(h=>{r.includes(h)&&(n+=15,d++)}),o.forEach(h=>{r.includes(h)&&(n+=8)}),c.forEach(h=>{r.includes(h)&&(n+=12)}),r.length>50&&(n+=10),r.length<20&&d>0&&(n+=15),["pessoa","coisa","algo","alguém","isso"].forEach(h=>{(r===h||r===`uma ${h}`||r===`um ${h}`)&&(n-=20)}),["primeiro","última","melhor","pior","favorito","importante"].some(h=>t.includes(h))&&d>0&&(n+=20),Math.min(100,Math.max(0,n))}function ar(s,e){if(!e||e.length===0)return null;const t=e.map(n=>({card:n,score:xt(s,n)}));t.sort((n,i)=>i.score-n.score);const r=Math.random();return r<.7||t.length===1?t[0].card:r<.9&&t.length>1?t[1].card:t.length>2?t[2].card:t[0].card}function ir(s,e){if(!e||Object.keys(e).length===0)return null;const r=Object.keys(e).map(i=>({playerId:i,score:xt(s,e[i])}));r.sort((i,o)=>o.score-i.score);const n=Math.random();return n<.6||r.length===1?r[0].playerId:n<.9&&r.length>1?r[1].playerId:r.length>2?r[2].playerId:r[0].playerId}const De={LOBBY:["Preparados para rir até não aguentar mais? 🐵","Vamos ver quem tem as cartas mais sacanas hoje! 🃏","Bora começar logo essa farra, pessoal! 🎉","Preparem-se para combinações absolutamente absurdas! 😂","Que comece o caos! Adoro esse jogo! 🔥"],WAITING_FOR_PLAYERS:["Aguardando os atrasados... Como sempre! ⏰","Mais alguém vindo ou é só a galera raiz mesmo? 🤔","Paciência, pessoal. Já começa! ⌛","Quem faltar vai perder risadas épicas! 😄"],PLAYING:["Escolham com sabedoria... ou não! 😈","Essa rodada promete ser hilária! 🤣","Alguém vai se arrepender dessa escolha... 👀","Quero ver quem tem coragem de jogar essa carta! 😏","Pensem rápido! O tempo não espera! ⏱️","Essa vai ser boa, eu sinto! 🎭"],ROUND_VOTING:["Hora de escolher o FDP da rodada! 🏆","Qual combinação foi a mais absurda? 🤔","Votem na resposta mais criativa (ou bizarra)! 😂","Decisão difícil, hein? Todas são ótimas! 🔥","O FDP vai rir muito quando descobrir quem ganhou! 😈"],ROUND_RESULTS:["E o vencedor é... 🥁","Essa combinação foi genial! 🎉","Parabéns ao mais criativo (ou sem vergonha)! 🏆","Essa vai entrar para a história! 😂","Próxima rodada vem ainda melhor! 🔥"],GAME_OVER:["Que jogo épico! Parabéns ao campeão! 🏆🎉","Esse foi o melhor jogo que já vi! 🤩","O vencedor merece um troféu... ou terapia! 😅","Obrigado pelas risadas, pessoal! Joguem de novo! 🐵","Jogo finalizado! Quem topa revanche? 🔄"]};function or(s){const e=De[s]||De.LOBBY;return e[Math.floor(Math.random()*e.length)]}const x={LOBBY:"LOBBY",WAITING_FOR_PLAYERS:"WAITING_FOR_PLAYERS",PLAYING:"PLAYING",ROUND_VOTING:"ROUND_VOTING",ROUND_RESULTS:"ROUND_RESULTS",GAME_OVER:"GAME_OVER"},cr={maxPlayers:8,minPlayers:3,cardsPerPlayer:10,winningScore:5,roundTimer:120,votingTimer:60,resultsDelaySec:10},bt={gameState:x.LOBBY,gameConfig:cr,roomCode:null,isHost:!1,players:[],currentPlayer:null,currentFDP:null,currentQuestionCard:null,usedQuestionCards:[],playerHands:{},remainingAnswerCards:[],submittedAnswers:{},roundWinner:null,answerOrder:[],timeRemaining:null,gameHistory:[],scores:{},selectedCards:[],showResults:!1,error:null,loading:!1,streamMode:!1,kickedMessage:null},f={SET_GAME_CONFIG:"SET_GAME_CONFIG",SET_ROOM_CODE:"SET_ROOM_CODE",SET_IS_HOST:"SET_IS_HOST",SET_GAME_STATE:"SET_GAME_STATE",START_GAME:"START_GAME",ADD_PLAYER:"ADD_PLAYER",REMOVE_PLAYER:"REMOVE_PLAYER",SET_CURRENT_PLAYER:"SET_CURRENT_PLAYER",SET_CURRENT_FDP:"SET_CURRENT_FDP",UPDATE_PLAYER:"UPDATE_PLAYER",DEAL_CARDS:"DEAL_CARDS",SET_QUESTION_CARD:"SET_QUESTION_CARD",SUBMIT_ANSWER:"SUBMIT_ANSWER",SELECT_CARD:"SELECT_CARD",DESELECT_CARD:"DESELECT_CARD",CLEAR_SELECTED_CARDS:"CLEAR_SELECTED_CARDS",SET_ROUND_WINNER:"SET_ROUND_WINNER",NEXT_ROUND:"NEXT_ROUND",SET_TIME_REMAINING:"SET_TIME_REMAINING",SET_ERROR:"SET_ERROR",SET_LOADING:"SET_LOADING",SHOW_RESULTS:"SHOW_RESULTS",HIDE_RESULTS:"HIDE_RESULTS",RESET_GAME:"RESET_GAME",APPLY_SNAPSHOT:"APPLY_SNAPSHOT",SET_STREAM_MODE:"SET_STREAM_MODE",SET_KICKED_MESSAGE:"SET_KICKED_MESSAGE",SET_ANSWER_ORDER:"SET_ANSWER_ORDER"};function dr(s,e){switch(e.type){case f.SET_GAME_CONFIG:return{...s,gameConfig:{...s.gameConfig,...e.payload}};case f.SET_ROOM_CODE:return{...s,roomCode:e.payload};case f.SET_IS_HOST:return{...s,isHost:e.payload};case f.SET_GAME_STATE:{const t=e.payload;if(t===x.PLAYING&&!s.currentFDP&&s.players.length>0){console.warn("SET_GAME_STATE: Tentando entrar em PLAYING sem FDP. Definindo FDP automaticamente.");const r=s.players[0];return{...s,gameState:t,currentFDP:r.id}}return{...s,gameState:t}}case f.ADD_PLAYER:{const t=e.payload;return{...s,players:[...s.players,t],scores:{...s.scores,[t.id]:0}}}case f.REMOVE_PLAYER:{const t=e.payload;return{...s,players:s.players.filter(r=>r.id!==t),scores:Object.fromEntries(Object.entries(s.scores).filter(([r])=>r!==t))}}case f.SET_CURRENT_PLAYER:return{...s,currentPlayer:e.payload};case f.SET_CURRENT_FDP:return{...s,currentFDP:e.payload};case f.UPDATE_PLAYER:{const{playerId:t,updates:r}=e.payload;return{...s,players:s.players.map(n=>n.id===t?{...n,...r}:n)}}case f.DEAL_CARDS:{const{playerHands:t,remainingCards:r}=kt(s.players,s.gameConfig.cardsPerPlayer);return{...s,playerHands:t,remainingAnswerCards:r}}case f.SET_QUESTION_CARD:{const t=It(s.usedQuestionCards);return{...s,currentQuestionCard:t,usedQuestionCards:[...s.usedQuestionCards,t],submittedAnswers:{},roundWinner:null,answerOrder:[]}}case f.SUBMIT_ANSWER:{const{playerId:t,answerCard:r}=e.payload;return{...s,submittedAnswers:{...s.submittedAnswers,[t]:r},playerHands:{...s.playerHands,[t]:(s.playerHands[t]||[]).filter(n=>n!==r)}}}case f.SELECT_CARD:return{...s,selectedCards:[...s.selectedCards,e.payload]};case f.DESELECT_CARD:return{...s,selectedCards:s.selectedCards.filter(t=>t!==e.payload)};case f.CLEAR_SELECTED_CARDS:return{...s,selectedCards:[]};case f.SET_ROUND_WINNER:{const t=e.payload;return{...s,roundWinner:t,scores:{...s.scores,[t]:s.scores[t]+1},gameHistory:[...s.gameHistory,{question:s.currentQuestionCard,answers:s.submittedAnswers,winner:t,timestamp:new Date().toISOString()}]}}case f.NEXT_ROUND:{const t=s.players.filter(u=>u.id!==s.currentFDP),r={...s.playerHands};let n=0;const i=t.filter(u=>s.submittedAnswers[u.id]);if(s.remainingAnswerCards.length<i.length)return console.log("NEXT_ROUND: Cartas insuficientes para continuar. Terminando jogo."),{...s,gameState:x.GAME_OVER};t.forEach(u=>{if(Array.isArray(r[u.id])||(r[u.id]=[]),s.submittedAnswers[u.id]){const p=s.remainingAnswerCards[n];p&&(r[u.id]=[...r[u.id],p],n+=1)}});const c=(s.players.findIndex(u=>u.id===s.currentFDP)+1)%s.players.length,d=s.players[c].id;return console.log("NEXT_ROUND: FDP atual:",s.currentFDP,"Próximo FDP:",d,"Jogador:",s.players[c].name),console.log("NEXT_ROUND: Reiniciando rodada com gameState PLAYING"),{...s,gameState:x.PLAYING,playerHands:r,remainingAnswerCards:s.remainingAnswerCards.slice(n),currentFDP:d,submittedAnswers:{},roundWinner:null,selectedCards:[],answerOrder:[],timeRemaining:s.gameConfig.roundTimer}}case f.START_GAME:{const t=Oe(s.players),r=t[0]?.id;return console.log("START_GAME: Iniciando jogo"),console.log("- Jogadores antes do embaralhamento:",s.players.map(n=>({id:n.id,name:n.name}))),console.log("- Jogadores após embaralhamento:",t.map(n=>({id:n.id,name:n.name}))),console.log("- Primeiro FDP escolhido:",r),console.log("- Nome do FDP:",t[0]?.name),r?{...s,gameState:x.PLAYING,players:t,currentFDP:r,answerOrder:[]}:(console.error("ERRO: Não foi possível escolher FDP - array de jogadores vazio!"),s)}case f.SET_TIME_REMAINING:return{...s,timeRemaining:e.payload};case f.SET_ERROR:return{...s,error:e.payload};case f.SET_LOADING:return{...s,loading:e.payload};case f.SET_STREAM_MODE:return{...s,streamMode:!!e.payload};case f.SET_KICKED_MESSAGE:return{...s,kickedMessage:e.payload||null};case f.SET_ANSWER_ORDER:return{...s,answerOrder:Array.isArray(e.payload)?e.payload:[]};case f.SHOW_RESULTS:return{...s,showResults:!0};case f.HIDE_RESULTS:return{...s,showResults:!1};case f.RESET_GAME:return{...bt,currentPlayer:s.currentPlayer};case f.APPLY_SNAPSHOT:{const t=e.payload||{},r=s.currentPlayer,n={...t};n.isHost=s.isHost;const i=Array.isArray(t.players)?t.players:[],o=Array.isArray(s.players)?s.players:[],c=new Map;for(const p of i)c.set(p.id,p);for(const p of o)c.has(p.id)||c.set(p.id,p);n.players=Array.from(c.values());const d={...s.scores||{},...t.scores||{}};for(const p of n.players)d[p.id]===void 0&&(d[p.id]=0);n.scores=d;const u={...s.playerHands||{},...t.playerHands||{}};for(const p of n.players)Array.isArray(u[p.id])||(u[p.id]=[]);return n.playerHands=u,r&&(n.currentPlayer=r),n}default:return s}}const Et=S.createContext();function fr({children:s}){const[e,t]=S.useReducer(dr,bt),r=S.useRef(e);S.useRef(null);const n=S.useRef(`client_${Math.random().toString(36).slice(2)}`),i=S.useRef(!1),o=S.useRef(null);S.useEffect(()=>{r.current=e},[e]);const c=ve.useCallback(()=>{if(e.isHost)switch(e.gameState){case x.PLAYING:{const l=e.players.filter(m=>m.id!==e.currentFDP&&!e.submittedAnswers[m.id]);l.forEach(m=>{const v=e.playerHands[m.id][0];v&&t({type:f.SUBMIT_ANSWER,payload:{playerId:m.id,answerCard:v}})});const _=[...Array.from(new Set(Object.keys(e.submittedAnswers).concat(l.map(m=>m.id))))].sort(()=>Math.random()-.5);t({type:f.SET_ANSWER_ORDER,payload:_}),t({type:f.SET_GAME_STATE,payload:x.ROUND_VOTING}),e.gameConfig.votingTimer>0&&t({type:f.SET_TIME_REMAINING,payload:e.gameConfig.votingTimer}),setTimeout(()=>u(),0);break}case x.ROUND_VOTING:{const l=Object.keys(e.submittedAnswers);if(l.length>0){const h=l[Math.floor(Math.random()*l.length)];t({type:f.SET_ROUND_WINNER,payload:h}),(e.scores[h]||0)+1>=e.gameConfig.winningScore?(t({type:f.SET_GAME_STATE,payload:x.GAME_OVER}),setTimeout(()=>u(),10)):(t({type:f.SET_GAME_STATE,payload:x.ROUND_RESULTS}),setTimeout(()=>{t({type:f.NEXT_ROUND}),t({type:f.SET_QUESTION_CARD}),t({type:f.SET_GAME_STATE,payload:x.PLAYING}),t({type:f.SET_TIME_REMAINING,payload:e.gameConfig.roundTimer}),setTimeout(()=>u(),10)},(e.gameConfig?.resultsDelaySec??3)*1e3))}break}}},[e.isHost,e.gameState,e.players,e.currentFDP,e.submittedAnswers,e.playerHands,e.gameConfig?.votingTimer,e.gameConfig?.roundTimer,e.gameConfig?.resultsDelaySec]);S.useEffect(()=>{if(e.gameState!==x.PLAYING||!e.isHost)return;e.players.filter(h=>h.isBot&&h.id!==e.currentFDP).forEach(h=>{if(e.submittedAnswers[h.id])return;const _=2e3+Math.random()*6e3;setTimeout(()=>{const m=r.current;if(m.gameState!==x.PLAYING){console.log(`🤖 Bot ${h.name} cancelou jogada - jogo não está em PLAYING`);return}if(m.submittedAnswers[h.id]){console.log(`🤖 Bot ${h.name} cancelou jogada - já jogou`);return}const v=m.playerHands[h.id]||[];if(v.length===0){console.log(`🤖 Bot ${h.name} não tem cartas na mão`);return}const b=ar(m.currentQuestionCard,v);b&&(console.log(`🤖 Bot ${h.name} escolheu carta:`,b),t({type:f.SUBMIT_ANSWER,payload:{playerId:h.id,answerCard:b}}),d("ANSWER_SUBMITTED",{playerId:h.id,answerCard:b}))},_)})},[e.gameState,e.players,e.currentFDP,e.submittedAnswers,e.isHost,e.playerHands]),S.useEffect(()=>{if(e.gameState!==x.ROUND_VOTING||!e.isHost)return;const l=e.players.find(_=>_.id===e.currentFDP);if(!l||!l.isBot)return;const h=3e3+Math.random()*4e3;setTimeout(()=>{if(r.current.gameState===x.ROUND_VOTING){const _=ir(r.current.currentQuestionCard,r.current.submittedAnswers);_&&(console.log(`🤖 Bot FDP ${l.name} escolheu vencedor:`,_),t({type:f.SET_ROUND_WINNER,payload:_}),(r.current.scores[_]||0)+1>=r.current.gameConfig.winningScore?(t({type:f.SET_GAME_STATE,payload:x.GAME_OVER}),setTimeout(()=>u(),10)):(t({type:f.SET_GAME_STATE,payload:x.ROUND_RESULTS}),setTimeout(()=>u(),10),setTimeout(()=>{t({type:f.NEXT_ROUND}),t({type:f.SET_QUESTION_CARD}),t({type:f.SET_GAME_STATE,payload:x.PLAYING}),t({type:f.SET_TIME_REMAINING,payload:r.current.gameConfig.roundTimer}),setTimeout(()=>u(),10)},(r.current.gameConfig?.resultsDelaySec??3)*1e3)))}},h)},[e.gameState,e.players,e.currentFDP,e.isHost,e.submittedAnswers]),S.useEffect(()=>{let l;return e.timeRemaining>0?l=setTimeout(()=>{t({type:f.SET_TIME_REMAINING,payload:e.timeRemaining-1})},1e3):e.timeRemaining===0&&c(),()=>clearTimeout(l)},[e.timeRemaining,c]),S.useEffect(()=>{if(e.gameState===x.PLAYING){e.currentFDP||(console.error("INTEGRIDADE: Jogo em andamento sem FDP definido!"),e.isHost&&e.players.length>0&&(console.log("INTEGRIDADE: Host corrigindo - definindo primeiro jogador como FDP"),t({type:f.SET_CURRENT_FDP,payload:e.players[0].id})));const l=e.players.some(h=>h.id===e.currentFDP);e.currentFDP&&!l&&(console.error("INTEGRIDADE: FDP atual não existe na lista de jogadores!"),e.isHost&&e.players.length>0&&(console.log("INTEGRIDADE: Host corrigindo - redefinindo FDP"),t({type:f.SET_CURRENT_FDP,payload:e.players[0].id})))}},[e.gameState,e.currentFDP,e.players,e.isHost]);const d=(l,h)=>{if(!D.peer)return;const _=JSON.stringify({type:l,payload:h,sender:n.current,ts:Date.now()});D.broadcast(_)},u=ve.useCallback(()=>{i.current||d("STATE_SNAPSHOT",{...r.current})},[]);S.useEffect(()=>{if(e.roomCode&&o.current!==e.roomCode){o.current=e.roomCode;const l=_=>{const m=typeof _=="string"?JSON.parse(_):_;if(!m||m.sender===n.current)return;const{type:v,payload:b}=m;switch(v){case"PLAYER_JOIN":{r.current.players.some(E=>E.id===b.id)||t({type:f.ADD_PLAYER,payload:b}),r.current.isHost&&setTimeout(()=>u(),50);break}case"PLAYER_LEAVE":{t({type:f.REMOVE_PLAYER,payload:b});const y=r.current.currentPlayer?.id;y&&b===y&&t({type:f.SET_KICKED_MESSAGE,payload:"O host te removeu da sala."}),r.current.isHost&&u();break}case"STATE_SNAPSHOT":{i.current=!0,t({type:f.APPLY_SNAPSHOT,payload:b}),setTimeout(()=>{i.current=!1},0);break}case"ANSWER_SUBMITTED":{const{playerId:y,answerCard:E}=b||{};y&&E&&(t({type:f.SUBMIT_ANSWER,payload:{playerId:y,answerCard:E}}),r.current.isHost&&setTimeout(()=>{const C=r.current;if(C.gameState!==x.PLAYING)return;const j=C.players.filter(ge=>ge.id!==C.currentFDP).length,U=Object.keys(C.submittedAnswers).length;if(console.log(`📊 Respostas: ${U}/${j} recebidas`),U>=j){console.log("✅ Todas as respostas recebidas! Avançando para votação...");const Tt=[...Object.keys(C.submittedAnswers)].sort(()=>Math.random()-.5);t({type:f.SET_ANSWER_ORDER,payload:Tt}),t({type:f.SET_GAME_STATE,payload:x.ROUND_VOTING}),C.gameConfig.votingTimer>0&&t({type:f.SET_TIME_REMAINING,payload:C.gameConfig.votingTimer}),setTimeout(()=>u(),10)}},50));break}case"WINNER_SELECTED":{if(r.current.isHost){const y=b?.winnerId,E=r.current;y&&E.gameState===x.ROUND_VOTING&&(t({type:f.SET_ROUND_WINNER,payload:y}),(E.scores[y]||0)+1>=E.gameConfig.winningScore?(t({type:f.SET_GAME_STATE,payload:x.GAME_OVER}),setTimeout(()=>u(),10)):(t({type:f.SET_GAME_STATE,payload:x.ROUND_RESULTS}),setTimeout(()=>u(),10),setTimeout(()=>{t({type:f.NEXT_ROUND}),t({type:f.SET_QUESTION_CARD}),t({type:f.SET_GAME_STATE,payload:x.PLAYING}),t({type:f.SET_TIME_REMAINING,payload:r.current.gameConfig.roundTimer}),setTimeout(()=>u(),10)},(r.current.gameConfig?.resultsDelaySec??3)*1e3)))}break}case"SNAPSHOT_REQUEST":{r.current.isHost&&u();break}}};D.onMessage(l),(async()=>{try{e.isHost?(console.log("🎮 Inicializando como HOST..."),await D.initializeAsHost(e.roomCode),console.log("✅ Host inicializado com sucesso!")):(console.log("👥 Conectando à sala como PLAYER..."),await D.connectToRoom(e.roomCode),console.log("✅ Conectado à sala com sucesso!"),r.current.currentPlayer&&d("PLAYER_JOIN",r.current.currentPlayer),setTimeout(()=>d("SNAPSHOT_REQUEST",null),100))}catch(_){console.error("❌ Erro ao inicializar peer:",_),t({type:f.SET_ERROR,payload:"Erro ao conectar à sala. Tente novamente."})}})(),e.isHost&&r.current.currentPlayer&&setTimeout(()=>d("PLAYER_JOIN",r.current.currentPlayer),200)}return()=>{D.removeMessageListener(handleMessage)}},[e.roomCode,e.isHost,u]),S.useEffect(()=>{const l=()=>{if(r.current.currentPlayer)try{d("PLAYER_LEAVE",r.current.currentPlayer.id),D.disconnect()}catch{}};return window.addEventListener("beforeunload",l),()=>{window.removeEventListener("beforeunload",l),D.disconnect()}},[]);const p={setGameConfig:l=>{if(!e.isHost){t({type:f.SET_ERROR,payload:"Somente o host pode alterar as configurações."});return}t({type:f.SET_GAME_CONFIG,payload:l}),e.isHost&&setTimeout(()=>u(),0)},setRoomCode:l=>{e.roomCode&&!e.isHost||t({type:f.SET_ROOM_CODE,payload:l})},setIsHost:l=>t({type:f.SET_IS_HOST,payload:l}),setGameState:l=>t({type:f.SET_GAME_STATE,payload:l}),addPlayer:l=>{if(console.log("🔧 DEBUG addPlayer: Tentando adicionar player:",l),console.log("🔧 DEBUG addPlayer: Estado atual players:",e.players.length),l?.isBot&&!e.isHost){t({type:f.SET_ERROR,payload:"Somente o host pode adicionar bots."});return}t({type:f.ADD_PLAYER,payload:l}),d("PLAYER_JOIN",l)},removePlayer:l=>{const h=e.currentPlayer&&e.currentPlayer.id===l;if(!e.isHost&&!h){t({type:f.SET_ERROR,payload:"Somente o host pode remover outros jogadores."});return}t({type:f.REMOVE_PLAYER,payload:l}),d("PLAYER_LEAVE",l)},setCurrentPlayer:l=>t({type:f.SET_CURRENT_PLAYER,payload:l}),updatePlayer:(l,h)=>t({type:f.UPDATE_PLAYER,payload:{playerId:l,updates:h}}),startGame:()=>{if(!e.isHost){t({type:f.SET_ERROR,payload:"Somente o host pode iniciar o jogo."});return}if(e.players.length<e.gameConfig.minPlayers){t({type:f.SET_ERROR,payload:`Mínimo de ${e.gameConfig.minPlayers} jogadores necessário.`});return}console.log("====== INICIANDO JOGO ======"),console.log("startGame: Jogadores disponíveis:",e.players.map(l=>({id:l.id,name:l.name}))),console.log("startGame: Total de jogadores:",e.players.length),console.log("startGame: Distribuindo cartas..."),t({type:f.DEAL_CARDS}),console.log("startGame: Iniciando jogo e definindo FDP..."),t({type:f.START_GAME}),console.log("startGame: Definindo carta de pergunta..."),t({type:f.SET_QUESTION_CARD}),console.log("startGame: Iniciando timer..."),t({type:f.SET_TIME_REMAINING,payload:e.gameConfig.roundTimer}),console.log("====== FIM DA INICIALIZAÇÃO ======"),setTimeout(()=>{e.isHost&&(console.log("startGame: Enviando snapshot para clientes..."),u())},100)},submitAnswer:l=>{if(e.currentPlayer&&e.currentPlayer.id!==e.currentFDP){if(e.submittedAnswers[e.currentPlayer.id])return;if(t({type:f.SUBMIT_ANSWER,payload:{playerId:e.currentPlayer.id,answerCard:l}}),d("ANSWER_SUBMITTED",{playerId:e.currentPlayer.id,answerCard:l}),e.isHost||setTimeout(()=>d("SNAPSHOT_REQUEST",null),80),e.isHost){const h=e.players.filter(v=>v.id!==e.currentFDP).length,_=Object.keys(e.submittedAnswers).filter(v=>v!==e.currentFDP);if(new Set([..._,e.currentPlayer.id]).size>=h&&e.gameState===x.PLAYING){const b=[...Array.from(new Set([..._,e.currentPlayer.id]))].sort(()=>Math.random()-.5);t({type:f.SET_ANSWER_ORDER,payload:b}),t({type:f.SET_GAME_STATE,payload:x.ROUND_VOTING}),e.gameConfig.votingTimer>0&&t({type:f.SET_TIME_REMAINING,payload:e.gameConfig.votingTimer}),setTimeout(()=>u(),0)}}}},selectWinner:l=>{if(!e.currentPlayer||e.currentPlayer.id!==e.currentFDP)return;if(!e.isHost){d("WINNER_SELECTED",{winnerId:l});return}t({type:f.SET_ROUND_WINNER,payload:l}),(e.scores[l]||0)+1>=e.gameConfig.winningScore?(t({type:f.SET_GAME_STATE,payload:x.GAME_OVER}),setTimeout(()=>u(),10)):(t({type:f.SET_GAME_STATE,payload:x.ROUND_RESULTS}),setTimeout(()=>u(),10),setTimeout(()=>{t({type:f.NEXT_ROUND}),t({type:f.SET_QUESTION_CARD}),t({type:f.SET_GAME_STATE,payload:x.PLAYING}),t({type:f.SET_TIME_REMAINING,payload:e.gameConfig.roundTimer}),setTimeout(()=>u(),10)},(e.gameConfig?.resultsDelaySec??3)*1e3))},selectCard:l=>t({type:f.SELECT_CARD,payload:l}),deselectCard:l=>t({type:f.DESELECT_CARD,payload:l}),clearSelectedCards:()=>t({type:f.CLEAR_SELECTED_CARDS}),startTimer:l=>t({type:f.SET_TIME_REMAINING,payload:l}),stopTimer:()=>t({type:f.SET_TIME_REMAINING,payload:null}),setError:l=>t({type:f.SET_ERROR,payload:l}),setLoading:l=>t({type:f.SET_LOADING,payload:l}),setStreamMode:l=>{if(!e.isHost){t({type:f.SET_ERROR,payload:"Somente o host pode alterar a visibilidade do código da sala."});return}t({type:f.SET_STREAM_MODE,payload:l}),e.isHost&&setTimeout(()=>u(),0)},showResults:()=>t({type:f.SHOW_RESULTS}),hideResults:()=>t({type:f.HIDE_RESULTS}),setKickedMessage:l=>t({type:f.SET_KICKED_MESSAGE,payload:l}),resetGame:()=>{t({type:f.RESET_GAME}),e.isHost&&setTimeout(()=>u(),0)}};return a.jsx(Et.Provider,{value:{state:e,actions:p,GAME_STATES:x},children:s})}function $(){const s=S.useContext(Et);if(!s)throw new Error("useGame deve ser usado dentro de um GameProvider");return s}function _e({size:s=96,variant:e="inline",floating:t=!0,glow:r=!0,speech:n,ariaLabel:i="Mascote do jogo",className:o=""}){const c=typeof s=="number"?`${s}px`:s;return a.jsxs("div",{className:`mascot ${e==="hero"?"mascot--hero":"mascot--inline"} ${t?"is-floating":""} ${r?"has-glow":""} ${o}`,style:{"--mascot-size":c},role:"img","aria-label":i,children:[a.jsx("div",{className:"mascot-ring","aria-hidden":"true"}),a.jsx("img",{className:"mascot-img",src:"/fdp/mascot_monkey.svg",alt:"",loading:"lazy"}),n&&a.jsx("div",{className:"mascot-speech","aria-hidden":"true",children:n})]})}function ke({onJoinRoom:s,onBack:e}){const{actions:t}=$(),[r,n]=S.useState([]),[i,o]=S.useState(""),[c,d]=S.useState(!1),[u,p]=S.useState(!1),l=async()=>{p(!0),await new Promise(E=>setTimeout(E,1e3));const y=[{id:"pub_001",name:"Sala dos Amigos",host:"João123",players:4,maxPlayers:8,status:"WAITING_FOR_PLAYERS",isPrivate:!1,created:new Date(Date.now()-600*1e3),gameConfig:{winningScore:5,roundTimer:120}},{id:"pub_002",name:"FDP Hardcore",host:"ProPlayer",players:6,maxPlayers:8,status:"PLAYING",isPrivate:!1,created:new Date(Date.now()-1500*1e3),gameConfig:{winningScore:7,roundTimer:90}},{id:"pub_003",name:"Diversão Garantida 😂",host:"Engraçado",players:2,maxPlayers:6,status:"WAITING_FOR_PLAYERS",isPrivate:!1,created:new Date(Date.now()-300*1e3),gameConfig:{winningScore:5,roundTimer:120}},{id:"pub_004",name:"Só os Brabo",host:"MasterFDP",players:7,maxPlayers:8,status:"WAITING_FOR_PLAYERS",isPrivate:!1,created:new Date(Date.now()-180*1e3),gameConfig:{winningScore:10,roundTimer:60}},{id:"pub_005",name:"Iniciantes Bem-vindos",host:"Helper",players:1,maxPlayers:4,status:"WAITING_FOR_PLAYERS",isPrivate:!1,created:new Date(Date.now()-60*1e3),gameConfig:{winningScore:3,roundTimer:180}}];n(y),p(!1)};S.useEffect(()=>{l()},[]);const h=r.filter(y=>y.name.toLowerCase().includes(i.toLowerCase())||y.host.toLowerCase().includes(i.toLowerCase())),_=async y=>{if(y.players>=y.maxPlayers){t.setError("Sala lotada!");return}if(y.status==="PLAYING"){t.setError("Jogo já em andamento!");return}d(!0);try{await new Promise(E=>setTimeout(E,1500)),s(y.id,y.name)}catch(E){console.error("Erro ao entrar na sala:",E),t.setError("Erro ao entrar na sala")}finally{d(!1)}},m=y=>{switch(y){case"WAITING_FOR_PLAYERS":return"⏳";case"PLAYING":return"🎮";default:return"❓"}},v=y=>{switch(y){case"WAITING_FOR_PLAYERS":return"Aguardando";case"PLAYING":return"Jogando";default:return"Desconhecido"}},b=y=>{const E=Math.floor((Date.now()-y.getTime())/6e4);if(E<1)return"Agora";if(E===1)return"1 min";if(E<60)return`${E} min`;const C=Math.floor(E/60);return C===1?"1 hora":`${C} horas`};return a.jsxs("div",{className:"public-rooms",children:[a.jsxs("div",{className:"public-rooms-header",children:[a.jsxs("button",{className:"back-btn",onClick:e,children:[a.jsx("span",{children:"←"})," Voltar"]}),a.jsx("h2",{children:"🌍 Salas Públicas"}),a.jsxs("button",{className:`refresh-btn ${u?"loading":""}`,onClick:l,disabled:u,children:["🔄 ",u?"Atualizando...":"Atualizar"]})]}),a.jsx("div",{className:"search-section",children:a.jsxs("div",{className:"search-box",children:[a.jsx("span",{className:"search-icon",children:"🔍"}),a.jsx("input",{type:"text",placeholder:"Buscar por nome da sala ou host...",value:i,onChange:y=>o(y.target.value),className:"search-input"}),i&&a.jsx("button",{className:"clear-search",onClick:()=>o(""),children:"✕"})]})}),a.jsxs("div",{className:"rooms-list",children:[c&&a.jsxs("div",{className:"loading-overlay",children:[a.jsx("div",{className:"spinner"}),a.jsx("p",{children:"Entrando na sala..."})]}),h.length===0&&!u&&a.jsxs("div",{className:"no-rooms",children:[a.jsx("span",{className:"no-rooms-icon",children:"😔"}),a.jsx("h3",{children:"Nenhuma sala encontrada"}),a.jsx("p",{children:i?"Tente buscar por outros termos ou limpe a busca":"Não há salas públicas disponíveis no momento"}),a.jsx("button",{className:"btn btn-primary",onClick:l,children:"🔄 Tentar novamente"})]}),h.map(y=>a.jsxs("div",{className:"room-card",children:[a.jsxs("div",{className:"room-info",children:[a.jsxs("div",{className:"room-header",children:[a.jsx("h3",{className:"room-name",children:y.name}),a.jsxs("div",{className:"room-status",children:[a.jsx("span",{className:"status-icon",children:m(y.status)}),a.jsx("span",{className:"status-text",children:v(y.status)})]})]}),a.jsxs("div",{className:"room-details",children:[a.jsxs("div",{className:"room-host",children:[a.jsx("span",{className:"detail-icon",children:"👑"}),a.jsxs("span",{children:["Host: ",a.jsx("strong",{children:y.host})]})]}),a.jsxs("div",{className:"room-players",children:[a.jsx("span",{className:"detail-icon",children:"👥"}),a.jsxs("span",{children:[a.jsxs("strong",{children:[y.players,"/",y.maxPlayers]})," jogadores"]})]}),a.jsxs("div",{className:"room-config",children:[a.jsx("span",{className:"detail-icon",children:"🎯"}),a.jsxs("span",{children:[y.gameConfig.winningScore," pontos para vencer"]})]}),a.jsxs("div",{className:"room-timer",children:[a.jsx("span",{className:"detail-icon",children:"⏱️"}),a.jsxs("span",{children:[y.gameConfig.roundTimer,"s por rodada"]})]})]}),a.jsx("div",{className:"room-meta",children:a.jsxs("span",{className:"room-age",children:["Criada há ",b(y.created)]})})]}),a.jsx("div",{className:"room-actions",children:a.jsx("button",{className:`join-btn ${y.players>=y.maxPlayers?"full":y.status==="PLAYING"?"playing":"available"}`,onClick:()=>_(y),disabled:y.players>=y.maxPlayers||y.status==="PLAYING"||c,children:y.players>=y.maxPlayers?a.jsx(a.Fragment,{children:"🚫 Lotada"}):y.status==="PLAYING"?a.jsx(a.Fragment,{children:"🎮 Jogando"}):a.jsx(a.Fragment,{children:"🚀 Entrar"})})})]},y.id))]})]})}function mr(){const{state:s,actions:e,GAME_STATES:t}=$(),[r,n]=S.useState(""),[i,o]=S.useState(""),[c,d]=S.useState(!1),u=S.useCallback(()=>{if(s.error){const m=setTimeout(()=>{e.setError(null)},5e3);return()=>clearTimeout(m)}},[s.error,e]);if(S.useEffect(()=>{if(c)return a.jsx(ke,{onJoinRoom:h,onBack:()=>d(!1)})},[s.error,u]),c)return a.jsx(ke,{onJoinRoom:h,onBack:()=>d(!1)});const p=()=>Math.random().toString(36).substring(2,8).toUpperCase(),l=(m=!1)=>{if(!r.trim()){e.setError("Digite seu nome antes de criar a sala!");return}const v=p(),b={id:`player_${Date.now()}`,name:r.trim(),isHost:!0,avatar:`https://ui-avatars.com/api/?name=${encodeURIComponent(r)}&background=random`};e.setIsHost(!0),e.setCurrentPlayer(b),e.setRoomCode(v),e.addPlayer(b),e.setGameState(t.WAITING_FOR_PLAYERS),e.setError(null),m&&console.log("Criando sala pública:",v)},h=(m,v)=>{if(!r.trim()){e.setError("Digite seu nome primeiro!"),d(!1);return}const b={id:`player_${Date.now()}`,name:r.trim(),isHost:!1,avatar:`https://ui-avatars.com/api/?name=${encodeURIComponent(r)}&background=random`};e.setIsHost(!1),e.setCurrentPlayer(b),e.addPlayer(b),e.setRoomCode(m),e.setGameState(t.WAITING_FOR_PLAYERS),e.setError(null),console.log(`Entrando na sala pública: ${v} (${m})`)},_=()=>{if(!r.trim()){e.setError("Digite seu nome para entrar na sala!");return}if(!i.trim()){e.setError("Digite o código da sala!");return}const m={id:`player_${Date.now()}`,name:r.trim(),isHost:!1,avatar:`https://ui-avatars.com/api/?name=${encodeURIComponent(r)}&background=random`};e.setIsHost(!1),e.setCurrentPlayer(m),e.setRoomCode(i.trim()),e.addPlayer(m),e.setGameState(t.WAITING_FOR_PLAYERS),e.setError(null)};return a.jsx("div",{className:"lobby",children:a.jsxs("div",{className:"lobby-container",children:[a.jsx("div",{className:"lobby-header-compact",children:a.jsxs("div",{className:"brand-section",children:[a.jsx(_e,{variant:"hero",size:80,className:"mascot-hero"}),a.jsx("div",{className:"brand-text",children:a.jsxs("h1",{className:"game-title-compact",children:[a.jsx("span",{className:"title-main",children:"Foi De Propósito"}),a.jsx("span",{className:"title-subtitle",children:"O jogo mais FDP que existe!"})]})})]})}),a.jsxs("div",{className:"lobby-two-columns",children:[a.jsx("div",{className:"left-column",children:a.jsxs("div",{className:"actions-section",children:[a.jsx("h2",{children:"🎮 Começar a Jogar"}),a.jsxs("div",{className:"multiplayer-warning multiplayer-success",children:[a.jsx("div",{className:"warning-icon",children:"🌐"}),a.jsxs("div",{className:"warning-content",children:[a.jsx("strong",{children:"✨ Multiplayer Online Ativado!"}),a.jsxs("p",{children:["Agora você pode jogar com amigos em ",a.jsx("strong",{children:"computadores diferentes"})," usando conexão P2P!"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Como funciona:"})," Um jogador cria a sala e compartilha o código. Os outros entram com o código."]}),a.jsxs("p",{className:"tip",children:["💡 ",a.jsx("em",{children:"Dica:"})," Se tiver problemas de conexão, todos na mesma rede Wi-Fi funciona melhor!"]})]})]}),a.jsxs("div",{className:"name-form-compact",children:[a.jsx("label",{children:"Seu nome no jogo:"}),a.jsxs("div",{className:"input-group-compact",children:[a.jsx("input",{type:"text",placeholder:"Digite seu nome...",value:r,onChange:m=>n(m.target.value),onKeyPress:m=>m.key==="Enter"&&l(),maxLength:20,className:"name-input-compact"}),r&&a.jsx("div",{className:"avatar-preview-compact",children:a.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(r)}&background=random`,alt:"Avatar",className:"avatar-compact"})})]})]}),a.jsxs("div",{className:"game-options",children:[a.jsxs("div",{className:"option-card",children:[a.jsxs("div",{className:"option-header",children:[a.jsx("span",{className:"option-icon",children:"🎮"}),a.jsx("h3",{children:"Criar Nova Sala"})]}),a.jsx("p",{children:"Crie uma sala e convide seus amigos!"}),a.jsxs("div",{className:"option-buttons",children:[a.jsx("button",{className:"btn btn-create-private btn-full",onClick:()=>l(!1),disabled:!r.trim(),children:"🔒 Sala Privada"}),a.jsx("button",{className:"btn btn-create-public btn-full",onClick:()=>l(!0),disabled:!r.trim(),children:"🌍 Sala Pública"})]})]}),a.jsxs("div",{className:"option-card",children:[a.jsxs("div",{className:"option-header",children:[a.jsx("span",{className:"option-icon",children:"🚪"}),a.jsx("h3",{children:"Entrar por Código"})]}),a.jsx("p",{children:"Tem um código de sala? Cole aqui!"}),a.jsxs("div",{className:"join-form",children:[a.jsx("input",{type:"text",placeholder:"Código da sala (ex: ABC123)",value:i,onChange:m=>o(m.target.value.toUpperCase()),onKeyPress:m=>m.key==="Enter"&&_(),maxLength:10,className:"code-input"}),a.jsx("button",{className:"btn btn-join-code btn-full",onClick:_,disabled:!r.trim()||!i.trim(),children:"Entrar na Sala"})]})]}),a.jsxs("div",{className:"option-card",children:[a.jsxs("div",{className:"option-header",children:[a.jsx("span",{className:"option-icon",children:"🌍"}),a.jsx("h3",{children:"Salas Públicas"})]}),a.jsx("p",{children:"Descubra salas abertas para todos!"}),a.jsx("button",{className:"btn btn-public-rooms btn-full",onClick:()=>d(!0),disabled:!r.trim(),children:"Explorar Salas Públicas"})]})]}),s.error&&a.jsxs("div",{className:"error-message",children:["❌ ",s.error]})]})}),a.jsx("div",{className:"right-column",children:a.jsxs("div",{className:"info-section",children:[a.jsxs("div",{className:"about-game",children:[a.jsx("h2",{children:"🎭 Sobre o Jogo"}),a.jsx("p",{className:"game-description-compact",children:"Prepare-se para muitas risadas, absurdos e momentos inesquecíveis! Complete as frases da maneira mais escrota possível e conquiste pontos fazendo todo mundo rir!"})]}),a.jsxs("div",{className:"rules-compact",children:[a.jsx("h3",{children:"🎯 Como Jogar"}),a.jsxs("div",{className:"rules-list",children:[a.jsxs("div",{className:"rule-item-compact",children:[a.jsx("span",{className:"rule-number",children:"1"}),a.jsxs("div",{className:"rule-text",children:[a.jsx("strong",{children:"Distribuição:"})," Cada jogador recebe 10 cartas de resposta"]})]}),a.jsxs("div",{className:"rule-item-compact",children:[a.jsx("span",{className:"rule-number",children:"2"}),a.jsxs("div",{className:"rule-text",children:[a.jsx("strong",{children:"Pergunta:"})," O FDP da vez lê uma carta de pergunta"]})]}),a.jsxs("div",{className:"rule-item-compact",children:[a.jsx("span",{className:"rule-number",children:"3"}),a.jsxs("div",{className:"rule-text",children:[a.jsx("strong",{children:"Resposta:"})," Todos escolhem a carta mais engraçada"]})]}),a.jsxs("div",{className:"rule-item-compact",children:[a.jsx("span",{className:"rule-number",children:"4"}),a.jsxs("div",{className:"rule-text",children:[a.jsx("strong",{children:"Votação:"})," O FDP escolhe a melhor resposta (1 ponto)"]})]}),a.jsxs("div",{className:"rule-item-compact",children:[a.jsx("span",{className:"rule-number",children:"5"}),a.jsxs("div",{className:"rule-text",children:[a.jsx("strong",{children:"Vitória:"})," Primeiro a fazer 5 pontos ganha!"]})]})]})]}),a.jsxs("div",{className:"tips-section",children:[a.jsx("h3",{children:"💡 Dicas"}),a.jsxs("ul",{className:"tips-list",children:[a.jsx("li",{children:"🎭 Seja criativo e pense fora da caixa"}),a.jsx("li",{children:"😂 Quanto mais absurdo, melhor!"}),a.jsx("li",{children:"🎯 Conheça o humor do seu grupo"}),a.jsx("li",{children:"⚡ Seja rápido nas escolhas"}),a.jsx("li",{children:"🏆 Divirta-se, ganhar é secundário!"})]})]}),a.jsx("div",{className:"warning-section",children:a.jsxs("div",{className:"warning-card",children:[a.jsx("span",{className:"warning-icon",children:"⚠️"}),a.jsxs("div",{className:"warning-text",children:[a.jsx("strong",{children:"Conteúdo Adulto"}),a.jsx("p",{children:"Este jogo contém humor ácido e politicamente incorreto. Recomendado apenas para maiores de 18 anos."})]})]})})]})})]}),a.jsx("div",{className:"lobby-footer-compact",children:a.jsx("p",{children:"Versão Web • Baseado no jogo original Foi De Propósito"})})]})})}function _r(){const{state:s,actions:e,GAME_STATES:t}=$(),[r,n]=S.useState(s.gameConfig),[i,o]=S.useState(!1),[c,d]=S.useState(!1);S.useEffect(()=>{s.players.length===0&&s.currentPlayer&&s.isHost&&e.addPlayer(s.currentPlayer)},[s.players.length,s.currentPlayer,s.isHost,e]),S.useEffect(()=>{s.isHost&&d(!!s.streamMode)},[s.streamMode,s.isHost]);const u=()=>{if(s.players.length<s.gameConfig.minPlayers){e.setError(`Mínimo de ${s.gameConfig.minPlayers} jogadores necessários!`);return}e.startGame()},p=()=>{e.resetGame()},l=(m,v)=>{const b={...r,[m]:v};n(b)},h=()=>{e.setGameConfig(r),o(!1),e.setError(null)},_=()=>{s.isHost&&navigator.clipboard.writeText(s.roomCode).then(()=>{const m=document.querySelector(".copy-button");m.textContent="✓ Copiado!",setTimeout(()=>{m.textContent="📋 Copiar"},2e3)})};return a.jsx("div",{className:"waiting-room",children:a.jsxs("div",{className:"waiting-room-container",children:[a.jsxs("div",{className:"room-header",children:[a.jsxs("div",{className:"room-title-wrap",children:[a.jsx(_e,{variant:"inline",size:42,className:"mascot-inline"}),a.jsx("h1",{className:"room-title",children:"Sala de Espera"})]}),a.jsxs("div",{className:"room-info",children:[a.jsxs("div",{className:"room-code-display",children:[a.jsx("span",{className:"room-code-label",children:"Código da Sala:"}),a.jsx("span",{className:`room-code ${s.streamMode&&(!s.isHost||c)?"blurred":""}`,title:s.streamMode?s.isHost?c?"Stream Mode ativo: código oculto para você e para os outros jogadores":"Stream Mode ativo: código visível para você e oculto para os outros":"Stream Mode: código oculto pelo host":"Código da sala",children:s.roomCode}),s.isHost?a.jsx("button",{className:"copy-button",onClick:_,disabled:!s.roomCode,children:"📋 Copiar"}):a.jsx("button",{className:"copy-button",disabled:!0,title:"Somente o host pode copiar",children:"📋 Copiar"}),s.isHost&&a.jsx("button",{className:"toggle-stream-btn",onClick:()=>e.setStreamMode(!s.streamMode),title:s.streamMode?"Desativar Stream Mode (mostrar código)":"Ativar Stream Mode (ocultar código)","aria-pressed":s.streamMode,children:s.streamMode?"🙈":"👁️"}),s.isHost&&s.streamMode&&a.jsx("button",{className:"toggle-stream-btn",onClick:()=>d(!c),title:c?"Mostrar código para mim":"Ocultar código para mim também","aria-pressed":c,children:c?"👁️‍🗨️":"🙊"})]}),a.jsxs("div",{className:"player-count",children:[s.players.length,"/",s.gameConfig.maxPlayers," jogadores"]})]}),s.streamMode&&a.jsxs("div",{className:"stream-mode-badge",title:s.isHost?"Stream Mode ativo: o código está visível para você e oculto para os demais jogadores.":"Stream Mode ativo: o host ocultou o código da sala.","aria-label":"Stream Mode ativo",children:[a.jsx("span",{className:"badge-icon","aria-hidden":!0,children:"🙈"}),s.isHost?"Stream Mode ativo":"Código oculto pelo host"]})]}),a.jsxs("div",{className:"players-section",children:[a.jsx("h2",{children:"Jogadores na Sala"}),a.jsxs("div",{className:"players-grid",children:[s.players.map(m=>a.jsxs("div",{className:`player-card ${m.isHost?"host":""} ${m.id===s.currentPlayer?.id?"current":""}`,children:[a.jsxs("div",{className:"player-avatar",children:[a.jsx("img",{src:m.avatar,alt:m.name}),m.isHost&&a.jsx("span",{className:"host-crown",children:"👑"}),m.isBot&&a.jsx("span",{className:"bot-badge",children:"🤖"})]}),a.jsxs("div",{className:"player-info",children:[a.jsx("div",{className:"player-name",children:m.name}),a.jsx("div",{className:"player-status",children:m.isHost?"Host":m.isBot?"Bot":"Jogador"})]}),s.isHost&&!m.isHost&&a.jsx("button",{className:"remove-player-btn",onClick:()=>e.removePlayer(m.id),children:"✕"})]},m.id)),Array.from({length:s.gameConfig.maxPlayers-s.players.length},(m,v)=>a.jsx("div",{className:"player-card empty",children:a.jsxs("div",{className:"empty-slot",children:[a.jsx("span",{className:"empty-icon",children:"👤"}),a.jsx("span",{className:"empty-text",children:"Aguardando..."})]})},`empty-${v}`))]})]}),a.jsxs("div",{className:"sidebar",children:[a.jsxs("div",{className:"action-buttons",children:[s.isHost?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"btn btn-primary btn-large",onClick:u,disabled:s.players.length<s.gameConfig.minPlayers,children:["🎮 Iniciar Jogo (",s.players.length,"/",s.gameConfig.minPlayers," min)"]}),!1]}):a.jsxs("div",{className:"waiting-message",children:[a.jsx("span",{className:"waiting-icon",children:"⏳"}),"Aguardando o host iniciar o jogo..."]}),a.jsx("button",{className:"btn btn-ghost",onClick:p,children:"🚪 Sair da Sala"}),s.isHost&&a.jsxs("div",{className:"config-section",children:[a.jsx("button",{className:"config-toggle-btn",onClick:()=>o(!i),children:"⚙️ Configurações do Jogo"}),i&&a.jsxs("div",{className:"config-panel",children:[a.jsxs("div",{className:"config-grid",children:[a.jsxs("div",{className:"config-item",children:[a.jsx("label",{children:"Cartas por Jogador:"}),a.jsxs("select",{value:r.cardsPerPlayer,onChange:m=>l("cardsPerPlayer",parseInt(m.target.value)),children:[a.jsx("option",{value:7,children:"7 cartas (Difícil)"}),a.jsx("option",{value:10,children:"10 cartas (Normal)"}),a.jsx("option",{value:12,children:"12 cartas (Fácil)"})]})]}),a.jsxs("div",{className:"config-item",children:[a.jsx("label",{children:"Pontos para Vencer:"}),a.jsxs("select",{value:r.winningScore,onChange:m=>l("winningScore",parseInt(m.target.value)),children:[a.jsx("option",{value:3,children:"3 pontos (Rápido)"}),a.jsx("option",{value:5,children:"5 pontos (Normal)"}),a.jsx("option",{value:7,children:"7 pontos (Longo)"})]})]}),a.jsxs("div",{className:"config-item",children:[a.jsx("label",{children:"Tempo por Rodada:"}),a.jsxs("select",{value:r.roundTimer,onChange:m=>l("roundTimer",parseInt(m.target.value)),children:[a.jsx("option",{value:60,children:"1 minuto"}),a.jsx("option",{value:120,children:"2 minutos"}),a.jsx("option",{value:180,children:"3 minutos"}),a.jsx("option",{value:0,children:"Sem limite"})]})]}),a.jsxs("div",{className:"config-item",children:[a.jsx("label",{children:"Máximo de Jogadores:"}),a.jsxs("select",{value:r.maxPlayers,onChange:m=>l("maxPlayers",parseInt(m.target.value)),children:[a.jsx("option",{value:4,children:"4 jogadores"}),a.jsx("option",{value:6,children:"6 jogadores"}),a.jsx("option",{value:8,children:"8 jogadores"}),a.jsx("option",{value:10,children:"10 jogadores"})]})]})]}),a.jsxs("div",{className:"config-buttons",children:[a.jsx("button",{className:"btn btn-primary",onClick:h,children:"Salvar Configurações"}),a.jsx("button",{className:"btn btn-ghost",onClick:()=>o(!1),children:"Cancelar"})]})]})]})]}),a.jsxs("div",{className:"rules-section",children:[a.jsx("h3",{children:"Regras Rápidas"}),a.jsxs("div",{className:"rules-list",children:[a.jsxs("p",{children:["• Cada jogador recebe ",r.cardsPerPlayer," cartas de resposta"]}),a.jsx("p",{children:"• O FDP da vez lê uma pergunta preta"}),a.jsx("p",{children:"• Todos os outros jogadores escolhem uma carta branca"}),a.jsx("p",{children:"• O FDP escolhe a resposta mais engraçada/absurda"}),a.jsxs("p",{children:["• Primeiro a fazer ",r.winningScore," pontos vence!"]}),a.jsx("p",{children:"• Conteúdo adulto - jogadores devem ter +18 anos"})]})]})]}),s.error&&a.jsxs("div",{className:"error-message",children:[a.jsx("span",{className:"error-icon",children:"⚠️"}),s.error,a.jsx("button",{className:"error-close",onClick:()=>e.setError(null),children:"×"})]}),s.kickedMessage&&a.jsx("div",{className:"modal-overlay",role:"dialog","aria-modal":"true","aria-labelledby":"kicked-title",children:a.jsxs("div",{className:"modal-card",children:[a.jsx("h3",{id:"kicked-title",className:"modal-title",children:"Você foi removido"}),a.jsx("p",{className:"modal-text",children:s.kickedMessage}),a.jsx("div",{className:"modal-actions",children:a.jsx("button",{className:"btn btn-primary",onClick:()=>{e.setKickedMessage(null),e.setGameState(t.LOBBY),e.resetGame()},children:"OK"})})]})})]})})}function lr({selectedCard:s,onCardSelect:e}){const{state:t}=$(),r=t.playerHands[t.currentPlayer?.id]||[],n=i=>{e(s===i?null:i)};return r.length===0?a.jsx("div",{className:"player-hand",children:a.jsx("div",{className:"no-cards",children:a.jsx("p",{children:"Carregando suas cartas..."})})}):a.jsxs("div",{className:"player-hand",children:[a.jsxs("div",{className:"hand-header",children:[a.jsx("h3",{children:s?a.jsxs(a.Fragment,{children:["✓ Carta Selecionada (",r.length-1," restantes)"]}):a.jsxs(a.Fragment,{children:["🎯 Suas Cartas (",r.length,")"]})}),a.jsx("p",{children:s?"Carta escolhida! Confirme sua jogada abaixo 👇":"Clique em uma carta para selecioná-la"})]}),a.jsx("div",{className:"cards-container",children:a.jsx("div",{className:"cards-grid",children:r.map((i,o)=>a.jsx("div",{className:`answer-card ${s===i?"selected":""}`,onClick:()=>n(i),children:a.jsxs("div",{className:"card-content",children:[a.jsx("div",{className:"card-text",children:i}),s===i&&a.jsx("div",{className:"selection-indicator",children:a.jsx("span",{className:"check-icon",children:"✓"})})]})},`${i}-${o}`))})})]})}function ur({question:s,answers:e,onSelectWinner:t,canVote:r,currentPlayer:n,order:i}){const o=Object.entries(e),c=i&&Array.isArray(i)&&i.length?i.filter(p=>e[p]!==void 0).map(p=>[p,e[p]]):o.sort((p,l)=>p[0].localeCompare(l[0])),d=(p,l)=>p.replace("______",`**${l}**`),u=p=>{r&&t(p)};return a.jsxs("div",{className:"submitted-answers",children:[a.jsxs("div",{className:"answers-header",children:[a.jsx("h3",{children:r?"👑 Escolha a melhor resposta clicando nela:":"🗳️ Respostas submetidas:"}),a.jsx("p",{className:"voting-instruction",children:r?"Como FDP desta rodada, você decide qual resposta ganha!":"Aguarde o FDP escolher a melhor resposta..."})]}),a.jsx("div",{className:"answers-grid",children:c.map(([p,l],h)=>{const _=p===n?.id;return a.jsxs("div",{className:`answer-option ${r?"votable":""} ${_?"own-answer":""}`,onClick:()=>u(p),children:[a.jsx("div",{className:"answer-number",children:h+1}),a.jsxs("div",{className:"answer-content",children:[a.jsx("div",{className:"complete-sentence",children:d(s,l)}),a.jsxs("div",{className:"answer-highlight",children:[a.jsx("span",{className:"answer-label",children:"Resposta:"}),a.jsx("span",{className:"answer-text",children:l})]})]}),r&&a.jsxs("div",{className:"vote-indicator",children:[a.jsx("span",{className:"vote-icon",children:"👆"}),a.jsx("span",{className:"vote-text",children:"Votar"})]}),_&&a.jsx("div",{className:"own-answer-badge",children:a.jsx("span",{children:"Sua resposta"})})]},p)})}),!r&&a.jsxs("div",{className:"waiting-for-vote",children:[a.jsx("div",{className:"waiting-animation",children:a.jsxs("span",{className:"waiting-dots",children:[a.jsx("span",{}),a.jsx("span",{}),a.jsx("span",{})]})}),a.jsx("p",{children:"⏳ Aguardando a decisão do FDP..."})]})]})}function pr(){const{state:s}=$();if(s.timeRemaining===null||s.timeRemaining===void 0)return null;const e=Math.floor(s.timeRemaining/60),t=s.timeRemaining%60,r=`${e}:${t.toString().padStart(2,"0")}`;s.gameConfig.roundTimer>0&&s.timeRemaining/s.gameConfig.roundTimer*100;const n=s.timeRemaining<=30,i=s.timeRemaining<=10;return a.jsx("div",{className:`timer ${n?"urgent":""} ${i?"critical":""}`,children:a.jsxs("div",{className:"timer-display",children:[a.jsx("span",{className:"timer-icon",children:"⏱️"}),a.jsx("span",{className:"timer-text",children:r})]})})}function se({showFinal:s=!1,showStatsOnly:e=!1}){const{state:t}=$();if(e)return a.jsx("div",{className:"scoreboard stats-only",children:a.jsxs("div",{className:"game-stats",children:[a.jsx("h3",{children:"📈 Estatísticas do Jogo"}),a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-value",children:t.gameHistory.length}),a.jsx("span",{className:"stat-label",children:"Rodadas Jogadas"})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-value",children:t.players.length}),a.jsx("span",{className:"stat-label",children:"Jogadores"})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-value",children:Math.max(...Object.values(t.scores))}),a.jsx("span",{className:"stat-label",children:"Maior Pontuação"})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-value",children:t.usedQuestionCards.length}),a.jsx("span",{className:"stat-label",children:"Perguntas Usadas"})]})]})]})});const r=[...t.players].sort((o,c)=>(t.scores[c.id]||0)-(t.scores[o.id]||0)),n=o=>{switch(o){case 0:return"🥇";case 1:return"🥈";case 2:return"🥉";default:return`${o+1}º`}},i=o=>{switch(o){case 0:return"first-place";case 1:return"second-place";case 2:return"third-place";default:return""}};return a.jsxs("div",{className:"scoreboard",children:[a.jsxs("div",{className:"scoreboard-header",children:[a.jsx("h2",{children:s?"🏆 Placar Final":"📊 Placar Atual"}),a.jsx("p",{className:"winning-score",children:s?"Parabéns ao vencedor!":`Primeiro a fazer ${t.gameConfig.winningScore} pontos vence!`})]}),a.jsx("div",{className:"players-ranking",children:r.map((o,c)=>{const d=t.scores[o.id]||0,u=s&&c===0,p=o.id===t.currentFDP,l=o.id===t.currentPlayer?.id;return a.jsxs("div",{className:`player-rank ${i(c)} ${u?"winner":""} ${p?"current-fdp":""} ${l?"current-player":""}`,children:[a.jsx("div",{className:"rank-position",children:n(c)}),a.jsxs("div",{className:"player-info",children:[a.jsxs("div",{className:"player-avatar",children:[a.jsx("img",{src:o.avatar,alt:o.name}),p&&a.jsx("span",{className:"fdp-crown",children:"👑"}),o.isBot&&a.jsx("span",{className:"bot-badge",children:"🤖"})]}),a.jsxs("div",{className:"player-details",children:[a.jsxs("div",{className:"player-name",children:[o.name,l&&a.jsx("span",{className:"you-badge",children:"Você"})]}),a.jsx("div",{className:"player-status",children:p?"FDP da vez":o.isBot?"Bot":"Jogador"})]})]}),a.jsxs("div",{className:"player-score",children:[a.jsx("div",{className:"score-number",children:d}),a.jsx("div",{className:"score-label",children:d===1?"ponto":"pontos"})]}),a.jsxs("div",{className:"score-progress",children:[a.jsx("div",{className:"progress-bar",children:a.jsx("div",{className:"progress-fill",style:{width:`${d/t.gameConfig.winningScore*100}%`}})}),a.jsxs("div",{className:"progress-text",children:[d,"/",t.gameConfig.winningScore]})]}),u&&a.jsxs("div",{className:"winner-effects",children:[a.jsx("span",{className:"trophy",children:"🏆"}),a.jsx("span",{className:"confetti",children:"🎉"})]})]},o.id)})}),!s&&t.gameHistory.length>0&&a.jsxs("div",{className:"recent-rounds",children:[a.jsx("h3",{children:"🕐 Últimas Rodadas"}),a.jsx("div",{className:"rounds-list",children:t.gameHistory.slice(-3).reverse().map((o,c)=>{const d=t.players.find(u=>u.id===o.winner);return a.jsxs("div",{className:"round-item",children:[a.jsxs("div",{className:"round-winner",children:[a.jsx("img",{src:d?.avatar,alt:d?.name}),a.jsx("span",{children:d?.name})]}),a.jsxs("div",{className:"round-answer",children:['"',o.answers[o.winner],'"']})]},c)})})]})]})}function gr(){const{state:s,actions:e,GAME_STATES:t}=$(),[r,n]=S.useState(null),[i,o]=S.useState(!1),[c,d]=S.useState(0),[u,p]=S.useState(""),l=s.currentPlayer?.id===s.currentFDP,h=s.submittedAnswers[s.currentPlayer?.id],_=s.players.filter(C=>C.id!==s.currentFDP).every(C=>s.submittedAnswers[C.id]);S.useEffect(()=>{console.log("GameBoard Debug:",{currentPlayer:s.currentPlayer?.name,currentFDP:s.players.find(C=>C.id===s.currentFDP)?.name,currentFDPId:s.currentFDP,isCurrentPlayerFDP:l,gameState:s.gameState,selectedAnswerCard:r,hasSubmittedAnswer:h,shouldShowButton:s.gameState===t.PLAYING&&!l,allPlayers:s.players.map(C=>({id:C.id,name:C.name}))}),s.gameState===t.PLAYING&&!s.currentFDP&&console.error("ERRO CRÍTICO: Jogo em andamento mas nenhum FDP definido!")},[s.currentPlayer,s.currentFDP,s.gameState,t.PLAYING,l,s.players,r,h]),S.useEffect(()=>{},[_,s.gameState,l]),S.useEffect(()=>{p(or(s.gameState))},[s.gameState]),S.useEffect(()=>{if(s.gameState===t.ROUND_RESULTS){const C=s.gameConfig?.resultsDelaySec??3;d(C);const j=setInterval(()=>{d(U=>U>0?U-1:0)},1e3);return()=>clearInterval(j)}else d(0)},[s.gameState,t.ROUND_RESULTS,s.gameConfig?.resultsDelaySec]);const m=()=>{r&&!h&&(e.submitAnswer(r),n(null))},v=C=>{l&&s.gameState===t.ROUND_VOTING&&e.selectWinner(C)},b=(C,j=null)=>C?j?C.replace("______",`**${j}**`):C:"",y=()=>{window.confirm("Tem certeza que deseja sair do jogo?")&&e.resetGame()},E=s.gameState===t.ROUND_RESULTS?" emote-celebrate":s.error?" emote-shake":"";return a.jsxs("div",{className:"game-board",children:[a.jsxs("div",{className:"game-header",children:[a.jsxs("div",{className:"game-info",children:[a.jsx(_e,{variant:"inline",className:"mascot-inline"+E,speech:u}),a.jsx("span",{className:"game-title",children:"Foi De Propósito"}),a.jsx("div",{style:{marginLeft:"20px"},children:a.jsx(pr,{})})]}),a.jsxs("div",{className:"header-actions",children:[a.jsxs("button",{className:"scoreboard-btn btn btn-secondary",onClick:()=>o(!0),children:[a.jsx("span",{role:"img","aria-label":"Placar",children:"📊"})," Placar"]}),a.jsxs("button",{className:"leave-btn btn btn-ghost",onClick:y,children:[a.jsx("span",{role:"img","aria-label":"Sair",children:"🚪"})," Sair"]})]})]}),s.gameState!==t.GAME_OVER&&a.jsx("div",{className:"question-section",children:a.jsxs("div",{className:"question-card",children:[a.jsxs("div",{className:"card-header",children:[a.jsx("span",{className:"card-type",children:"Carta de Pergunta"}),a.jsx("div",{className:"fdp-indicator",children:(()=>{const C=s.players.find(j=>j.id===s.currentFDP);return C?a.jsxs(a.Fragment,{children:["👑 FDP: ",C.name,l&&a.jsx("span",{className:"you-badge",children:" (VOCÊ!)"})]}):a.jsx("span",{style:{color:"red"},children:"⚠️ ERRO: Nenhum FDP definido!"})})()})]}),a.jsx("div",{className:"question-text",children:b(s.currentQuestionCard)})]})}),a.jsxs("div",{className:"game-main",children:[s.gameState===t.PLAYING&&!l&&a.jsx(lr,{selectedCard:r,onCardSelect:n}),s.gameState===t.PLAYING&&l&&a.jsx("div",{className:"fdp-waiting-section",children:a.jsxs("div",{className:"fdp-instructions",children:[a.jsx("h2",{children:"👑 Você é o FDP desta rodada!"}),a.jsx("p",{children:"Aguarde os outros jogadores enviarem suas respostas..."}),a.jsxs("div",{className:"fdp-status",children:[a.jsxs("div",{className:"responses-counter",children:[a.jsx("span",{children:Object.keys(s.submittedAnswers).length}),a.jsxs("span",{children:["/",s.players.filter(C=>C.id!==s.currentFDP).length]}),a.jsx("span",{children:" respostas recebidas"})]}),Object.keys(s.submittedAnswers).length<s.players.filter(C=>C.id!==s.currentFDP).length&&a.jsxs("div",{className:"waiting-animation",children:[a.jsxs("span",{className:"waiting-dots",children:[a.jsx("span",{}),a.jsx("span",{}),a.jsx("span",{})]}),a.jsx("p",{children:"Aguardando respostas..."})]})]})]})}),s.gameState===t.PLAYING&&!l&&a.jsx("button",{className:`btn btn-primary submit-answer-btn ${r?"has-selection":""} ${h?"submitted":""}`,onClick:m,disabled:!r||h,style:{position:"fixed",bottom:"30px",left:"50%",transform:"translateX(-50%)",zIndex:"9997",backgroundColor:r?"#28a745":"#6c757d",border:"none",padding:"15px 30px",fontSize:"1.2rem",fontWeight:"700",borderRadius:"15px",boxShadow:"0 8px 25px rgba(0,0,0,0.3)",color:"white"},children:h?a.jsxs(a.Fragment,{children:[a.jsx("span",{children:"✓"})," Resposta enviada!"]}):r?a.jsxs(a.Fragment,{children:[a.jsx("span",{children:"📤"})," Enviar resposta"]}):"Selecione uma carta"}),s.gameState===t.ROUND_VOTING&&a.jsx(ur,{question:s.currentQuestionCard,answers:s.submittedAnswers,onSelectWinner:v,canVote:l,currentPlayer:s.currentPlayer,order:s.answerOrder}),s.gameState===t.ROUND_RESULTS&&a.jsxs("div",{className:"round-results-section",children:[a.jsxs("div",{className:"celebration-header",children:[a.jsx("div",{className:"confetti-animation"}),a.jsx("div",{className:"trophy-bounce",children:a.jsx("span",{className:"celebration-trophy",children:"🏆"})}),a.jsx("h1",{className:"celebration-title",children:"Rodada Finalizada!"}),a.jsx("div",{className:"celebration-subtitle",children:"E o vencedor é..."})]}),a.jsxs("div",{className:"winner-spotlight",children:[a.jsxs("div",{className:"winner-avatar-container",children:[a.jsxs("div",{className:"winner-avatar",children:[a.jsx("div",{className:"avatar-initials",children:s.roundWinner&&s.players.find(C=>C.id===s.roundWinner)?.name?.slice(0,2).toUpperCase()||"??"}),a.jsx("div",{className:"winner-crown",children:"👑"})]}),a.jsx("div",{className:"winner-glow"})]}),a.jsxs("div",{className:"winner-info",children:[a.jsx("h2",{className:"winner-name",children:s.roundWinner&&s.players.find(C=>C.id===s.roundWinner)?.name||"Anônimo"}),a.jsx("div",{className:"winner-title",children:"🎭 FDP da Rodada"})]})]}),a.jsxs("div",{className:"winning-answer-showcase",children:[a.jsxs("div",{className:"question-display",children:[a.jsx("h3",{children:"🎯 Pergunta da Rodada:"}),a.jsx("div",{className:"question-card-display",children:s.currentQuestionCard})]}),a.jsxs("div",{className:"answer-spotlight",children:[a.jsx("h3",{children:"✨ Resposta Vencedora:"}),a.jsxs("div",{className:"winning-answer-card",children:[a.jsxs("div",{className:"answer-content",children:['"',s.submittedAnswers[s.roundWinner]||"Resposta não encontrada",'"']}),a.jsxs("div",{className:"answer-sparkles",children:[a.jsx("span",{children:"✨"}),a.jsx("span",{children:"🎉"}),a.jsx("span",{children:"⭐"})]})]})]}),a.jsxs("div",{className:"complete-sentence-display",children:[a.jsx("h4",{children:"📝 Frase Completa:"}),a.jsx("div",{className:"complete-sentence",children:b(s.currentQuestionCard,s.submittedAnswers[s.roundWinner])})]})]}),a.jsx("div",{className:"next-round-countdown",children:a.jsxs("div",{className:"countdown-container",children:[a.jsx("div",{className:"countdown-circle",children:a.jsx("div",{className:"countdown-number",children:c})}),a.jsxs("div",{className:"countdown-text",children:[a.jsx("span",{className:"next-round-label",children:"Próxima rodada em"}),a.jsx("span",{className:"countdown-subtitle",children:"Prepare-se! 🚀"})]})]})}),a.jsxs("div",{className:"mini-scoreboard",children:[a.jsx("h3",{children:"🏆 Placar Atual"}),a.jsx("div",{className:"mini-scores",children:s.players.sort((C,j)=>(s.scores[j.id]||0)-(s.scores[C.id]||0)).slice(0,3).map((C,j)=>a.jsxs("div",{className:`mini-score-item rank-${j+1}`,children:[a.jsx("span",{className:"rank-emoji",children:j===0?"🥇":j===1?"🥈":"🥉"}),a.jsx("span",{className:"player-name",children:C.name}),a.jsx("span",{className:"player-score",children:s.scores[C.id]||0})]},C.id))})]})]}),s.gameState===t.GAME_OVER&&a.jsxs("div",{className:"game-over-section expanded-game-over",children:[a.jsxs("div",{className:"expanded-final-winner",children:[a.jsxs("div",{className:"expanded-winner-podium",children:[a.jsx("span",{className:"trophy",role:"img","aria-label":"Troféu",children:"🏆"}),a.jsx("div",{className:"expanded-final-winner-avatar",children:a.jsx("span",{className:"winner-initials",children:s.players.find(C=>C.id===s.roundWinner)?.name?.slice(0,2).toUpperCase()})})]}),a.jsxs("div",{className:"winner-joke",children:[a.jsx("strong",{children:s.players.find(C=>C.id===s.roundWinner)?.name}),a.jsx("br",{}),"É o grande FDP vencedor!"]})]}),a.jsxs("div",{className:"expanded-content-grid",children:[a.jsx("div",{className:"expanded-left-column",children:a.jsx("div",{className:"expanded-scoreboard-wrapper",children:a.jsx(se,{showFinal:!0})})}),a.jsx("div",{className:"expanded-right-column",children:a.jsx("div",{className:"expanded-stats-wrapper",children:a.jsx(se,{showFinal:!0,showStatsOnly:!0})})})]}),a.jsx("div",{className:"expanded-game-over-actions",children:a.jsx("button",{className:"btn btn-primary",onClick:y,children:"Voltar ao Lobby"})})]})]}),i&&a.jsx("div",{className:"modal-overlay",children:a.jsxs("div",{className:"modal-content",children:[a.jsx("button",{className:"close-modal-btn",onClick:()=>o(!1),children:"×"}),a.jsx(se,{})]})})]})}export{fr as G,mr as L,_r as W,gr as a,a as j,S as r,$ as u};
